<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Analysis scripts: K. pneumoniae complex genomics • blantyreESBL</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Analysis scripts: K. pneumoniae complex genomics">
<meta property="og:description" content="blantyreESBL">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">blantyreESBL</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0.0000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/analysis-ecoli.html">Analysis scripts: E. coli genomics</a>
    </li>
    <li>
      <a href="../articles/analysis-kleb.html">Analysis scripts: K. pneumoniae complex genomics</a>
    </li>
    <li>
      <a href="../articles/analysis.html">Analysis scripts: longitudinal ESBL carriage dynamics</a>
    </li>
    <li>
      <a href="../articles/fitting-stan-models.html">Fitting and simulating from Stan models</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="analysis-kleb_files/header-attrs-2.10/header-attrs.js"></script><script src="analysis-kleb_files/kePrint-0.0.1/kePrint.js"></script><link href="analysis-kleb_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Analysis scripts: K. pneumoniae complex genomics</h1>
            
      
      
      <div class="hidden name"><code>analysis-kleb.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># library(dassimKlebs)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/rstatix/">rstatix</a></span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'rstatix'</span>
<span class="co">#&gt; The following object is masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     filter</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/liamrevell/phytools">phytools</a></span><span class="op">)</span>
<span class="co">#&gt; Loading required package: ape</span>
<span class="co">#&gt; Loading required package: maps</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://yulab-smu.top/treedata-book/">ggtree</a></span><span class="op">)</span>
<span class="co">#&gt; ggtree v3.0.4  For help: https://yulab-smu.top/treedata-book/</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; If you use ggtree in published research, please cite the most appropriate paper(s):</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; 1. Guangchuang Yu. Using ggtree to visualize data on tree-like structures. Current Protocols in Bioinformatics, 2020, 69:e96. doi:10.1002/cpbi.96</span>
<span class="co">#&gt; 2. Guangchuang Yu, Tommy Tsan-Yuk Lam, Huachen Zhu, Yi Guan. Two methods for mapping and visualizing associated data on phylogeny using ggtree. Molecular Biology and Evolution 2018, 35(12):3041-3043. doi:10.1093/molbev/msy194</span>
<span class="co">#&gt; 3. Guangchuang Yu, David Smith, Huachen Zhu, Yi Guan, Tommy Tsan-Yuk Lam. ggtree: an R package for visualization and annotation of phylogenetic trees with their covariates and other associated data. Methods in Ecology and Evolution 2017, 8(1):28-36. doi:10.1111/2041-210X.12628</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'ggtree'</span>
<span class="co">#&gt; The following object is masked from 'package:ape':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     rotate</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://ape-package.ird.fr/">ape</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/">cowplot</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/ggpubr/">ggpubr</a></span><span class="op">)</span>
<span class="co">#&gt; Loading required package: ggplot2</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'ggpubr'</span>
<span class="co">#&gt; The following object is masked from 'package:cowplot':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     get_legend</span>
<span class="co">#&gt; The following object is masked from 'package:ggtree':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     rotate</span>
<span class="co">#&gt; The following object is masked from 'package:ape':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     rotate</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'dplyr'</span>
<span class="co">#&gt; The following objects are masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     filter, lag</span>
<span class="co">#&gt; The following objects are masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     intersect, setdiff, setequal, union</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://forcats.tidyverse.org">forcats</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'tidyr'</span>
<span class="co">#&gt; The following object is masked from 'package:ggtree':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     expand</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://here.r-lib.org/">here</a></span><span class="op">)</span>
<span class="co">#&gt; here() starts at /Users/joelewis/R/packages/blantyreESBL</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/">kableExtra</a></span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'kableExtra'</span>
<span class="co">#&gt; The following object is masked from 'package:dplyr':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     group_rows</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'patchwork'</span>
<span class="co">#&gt; The following object is masked from 'package:cowplot':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     align_plots</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://scales.r-lib.org">scales</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://sjmgarnier.github.io/viridis/">viridis</a></span><span class="op">)</span>
<span class="co">#&gt; Loading required package: viridisLite</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'viridis'</span>
<span class="co">#&gt; The following object is masked from 'package:scales':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     viridis_pal</span>
<span class="co">#&gt; The following object is masked from 'package:maps':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     unemp</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">pheatmap</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/GuangchuangYu/ggplotify">ggplotify</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">blantyreESBL</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://stringr.tidyverse.org">stringr</a></span><span class="op">)</span>

<span class="va">sp_dc</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">k</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/trimws.html">trimws</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">k</span><span class="op">)</span>, nsmall <span class="op">=</span> <span class="va">k</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>
<span class="va">write_figs</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span>

<span class="kw">if</span> <span class="op">(</span><span class="va">write_figs</span><span class="op">)</span> <span class="op">{</span>
  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/files2.html">dir.exists</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"figures"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/files2.html">dir.create</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"figures"</span><span class="op">)</span><span class="op">)</span><span class="op">}</span>
  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/files2.html">dir.exists</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"tables"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/files2.html">dir.create</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"tables"</span><span class="op">)</span><span class="op">)</span><span class="op">}</span>
  
    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/files2.html">dir.exists</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"figures/kleb-genomics"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/base/files2.html">dir.create</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"figures/kleb-genomics"</span><span class="op">)</span><span class="op">)</span>
  <span class="op">}</span>
  
  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/files2.html">dir.exists</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"tables/kleb-genomics"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/base/files2.html">dir.create</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"tables/kleb-genomics"</span><span class="op">)</span><span class="op">)</span>
    <span class="op">}</span>
  
<span class="op">}</span></code></pre></div>
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>This document generates the tables and figures for the manuscript:</p>
<p><br></p>
<p><em>Genomic and antigenic diversity of carried <em>Klebsiella pneumoniae</em> isolates mirrors that of invasive isolates in Blantyre, Malawi </em></p>
<p><br></p>
<p>Joseph M Lewis<sup>1,2,3,4</sup>, , Madalitso Mphasa<sup>1</sup>, Rachel Banda<sup>1</sup>, Matthew Beale<sup>4</sup>, Jane Mallewa<sup>5</sup>, Eva Heinz<sup>2</sup>, Nicholas Thomson<sup>4</sup>, Nicholas A Feasey<sup>1,2</sup></p>
<ol style="list-style-type: decimal">
<li>Malawi Liverpool Wellcome Clinical Research Programme, Blantyre, Malawi</li>
<li>Department of Clinical Sciences, Liverpool School of Tropical Medicine, Liverpool, UK</li>
<li>Department of Clinical Infection, Microbiology and Immunology, University of Liverpool, Liverpool, UK</li>
<li>Wellcome Sanger Institute, Hinxton, UK</li>
<li>College of Medicine, University of Malawi, Malawi</li>
</ol>
</div>
<div id="assembly-stats-and-accession-numbers" class="section level2">
<h2 class="hasAnchor">
<a href="#assembly-stats-and-accession-numbers" class="anchor"></a>Assembly stats and accession numbers</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># load accessions and assembly stats</span>

<span class="va">btESBL_sequence_sample_metadata</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"Klebsiella"</span>, <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">transmute</a></span><span class="op">(</span><span class="st">"Sample accession"</span> <span class="op">=</span> <span class="va">accession</span>,
         <span class="st">"Lane name"</span> <span class="op">=</span> <span class="va">lane</span>,
         <span class="st">"No. contigs"</span> <span class="op">=</span> <span class="va">number_of_contigs</span>,
         <span class="st">"N50"</span> <span class="op">=</span> <span class="va">N50</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kbl.html">kbl</a></span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"Accession numbers and assembly statistics for included samples"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_classic.html">kable_classic</a></span><span class="op">(</span>full_width <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<table class="table  lightable-classic">
<caption>
Accession numbers and assembly statistics for included samples
</caption>
<thead><tr>
<th style="text-align:left;">
Sample accession
</th>
<th style="text-align:left;">
Lane name
</th>
<th style="text-align:right;">
No. contigs
</th>
<th style="text-align:right;">
N50
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
ERR6057876
</td>
<td style="text-align:left;">
34154_7_3
</td>
<td style="text-align:right;">
42
</td>
<td style="text-align:right;">
398104
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057877
</td>
<td style="text-align:left;">
34154_7_4
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
815040
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057878
</td>
<td style="text-align:left;">
34154_7_5
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
416814
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057879
</td>
<td style="text-align:left;">
34154_7_6
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:right;">
578196
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057880
</td>
<td style="text-align:left;">
34154_7_8
</td>
<td style="text-align:right;">
83
</td>
<td style="text-align:right;">
241627
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057881
</td>
<td style="text-align:left;">
34154_7_10
</td>
<td style="text-align:right;">
67
</td>
<td style="text-align:right;">
190680
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057882
</td>
<td style="text-align:left;">
34154_7_11
</td>
<td style="text-align:right;">
28
</td>
<td style="text-align:right;">
374232
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057883
</td>
<td style="text-align:left;">
34154_7_12
</td>
<td style="text-align:right;">
61
</td>
<td style="text-align:right;">
219836
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057884
</td>
<td style="text-align:left;">
34154_7_13
</td>
<td style="text-align:right;">
39
</td>
<td style="text-align:right;">
508183
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057885
</td>
<td style="text-align:left;">
34154_7_14
</td>
<td style="text-align:right;">
37
</td>
<td style="text-align:right;">
482415
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057886
</td>
<td style="text-align:left;">
34154_7_16
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
661690
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057887
</td>
<td style="text-align:left;">
34154_7_18
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
326635
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057888
</td>
<td style="text-align:left;">
34154_7_19
</td>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
532297
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057889
</td>
<td style="text-align:left;">
34154_7_20
</td>
<td style="text-align:right;">
56
</td>
<td style="text-align:right;">
203429
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057890
</td>
<td style="text-align:left;">
34154_7_22
</td>
<td style="text-align:right;">
53
</td>
<td style="text-align:right;">
280122
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057891
</td>
<td style="text-align:left;">
34154_7_23
</td>
<td style="text-align:right;">
40
</td>
<td style="text-align:right;">
361647
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057892
</td>
<td style="text-align:left;">
34154_7_24
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
811788
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057893
</td>
<td style="text-align:left;">
34154_7_25
</td>
<td style="text-align:right;">
43
</td>
<td style="text-align:right;">
441618
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057894
</td>
<td style="text-align:left;">
34154_7_26
</td>
<td style="text-align:right;">
48
</td>
<td style="text-align:right;">
292152
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057895
</td>
<td style="text-align:left;">
34154_7_27
</td>
<td style="text-align:right;">
121
</td>
<td style="text-align:right;">
372362
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057896
</td>
<td style="text-align:left;">
34154_7_30
</td>
<td style="text-align:right;">
29
</td>
<td style="text-align:right;">
377741
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057897
</td>
<td style="text-align:left;">
34154_7_31
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:right;">
1042763
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057898
</td>
<td style="text-align:left;">
34154_7_32
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:right;">
453707
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057899
</td>
<td style="text-align:left;">
34154_7_33
</td>
<td style="text-align:right;">
158
</td>
<td style="text-align:right;">
579186
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057901
</td>
<td style="text-align:left;">
34154_7_36
</td>
<td style="text-align:right;">
37
</td>
<td style="text-align:right;">
454335
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057902
</td>
<td style="text-align:left;">
34154_7_38
</td>
<td style="text-align:right;">
36
</td>
<td style="text-align:right;">
410104
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057903
</td>
<td style="text-align:left;">
34154_7_39
</td>
<td style="text-align:right;">
31
</td>
<td style="text-align:right;">
758176
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057904
</td>
<td style="text-align:left;">
34154_7_40
</td>
<td style="text-align:right;">
67
</td>
<td style="text-align:right;">
320677
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057905
</td>
<td style="text-align:left;">
34154_7_41
</td>
<td style="text-align:right;">
41
</td>
<td style="text-align:right;">
639936
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057906
</td>
<td style="text-align:left;">
34154_7_42
</td>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
424465
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057907
</td>
<td style="text-align:left;">
34154_7_44
</td>
<td style="text-align:right;">
81
</td>
<td style="text-align:right;">
169754
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057908
</td>
<td style="text-align:left;">
34154_7_46
</td>
<td style="text-align:right;">
29
</td>
<td style="text-align:right;">
1464071
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057909
</td>
<td style="text-align:left;">
34154_7_47
</td>
<td style="text-align:right;">
39
</td>
<td style="text-align:right;">
472256
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057910
</td>
<td style="text-align:left;">
34154_7_48
</td>
<td style="text-align:right;">
77
</td>
<td style="text-align:right;">
203827
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057911
</td>
<td style="text-align:left;">
34154_7_49
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:right;">
1042515
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057912
</td>
<td style="text-align:left;">
34154_7_50
</td>
<td style="text-align:right;">
31
</td>
<td style="text-align:right;">
471152
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057913
</td>
<td style="text-align:left;">
34154_7_52
</td>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
407840
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057914
</td>
<td style="text-align:left;">
34154_7_54
</td>
<td style="text-align:right;">
33
</td>
<td style="text-align:right;">
358180
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057915
</td>
<td style="text-align:left;">
34154_7_55
</td>
<td style="text-align:right;">
46
</td>
<td style="text-align:right;">
317618
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057916
</td>
<td style="text-align:left;">
34154_7_56
</td>
<td style="text-align:right;">
103
</td>
<td style="text-align:right;">
193216
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057917
</td>
<td style="text-align:left;">
34154_7_58
</td>
<td style="text-align:right;">
38
</td>
<td style="text-align:right;">
373601
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057918
</td>
<td style="text-align:left;">
34154_7_59
</td>
<td style="text-align:right;">
34
</td>
<td style="text-align:right;">
431290
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057919
</td>
<td style="text-align:left;">
34154_7_60
</td>
<td style="text-align:right;">
48
</td>
<td style="text-align:right;">
324706
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057921
</td>
<td style="text-align:left;">
34154_7_62
</td>
<td style="text-align:right;">
51
</td>
<td style="text-align:right;">
408198
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057922
</td>
<td style="text-align:left;">
34154_7_63
</td>
<td style="text-align:right;">
46
</td>
<td style="text-align:right;">
344926
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057925
</td>
<td style="text-align:left;">
34154_7_68
</td>
<td style="text-align:right;">
58
</td>
<td style="text-align:right;">
204836
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057926
</td>
<td style="text-align:left;">
34154_7_69
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:right;">
377614
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057927
</td>
<td style="text-align:left;">
34154_7_70
</td>
<td style="text-align:right;">
104
</td>
<td style="text-align:right;">
154943
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057929
</td>
<td style="text-align:left;">
34154_7_74
</td>
<td style="text-align:right;">
63
</td>
<td style="text-align:right;">
209640
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057930
</td>
<td style="text-align:left;">
34154_7_75
</td>
<td style="text-align:right;">
37
</td>
<td style="text-align:right;">
358303
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057931
</td>
<td style="text-align:left;">
34154_7_76
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
602453
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057932
</td>
<td style="text-align:left;">
34154_7_77
</td>
<td style="text-align:right;">
55
</td>
<td style="text-align:right;">
272185
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057933
</td>
<td style="text-align:left;">
34154_7_78
</td>
<td style="text-align:right;">
61
</td>
<td style="text-align:right;">
188445
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057934
</td>
<td style="text-align:left;">
34154_7_80
</td>
<td style="text-align:right;">
42
</td>
<td style="text-align:right;">
472259
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057936
</td>
<td style="text-align:left;">
34154_7_83
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
718728
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057937
</td>
<td style="text-align:left;">
34154_7_84
</td>
<td style="text-align:right;">
56
</td>
<td style="text-align:right;">
169243
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057938
</td>
<td style="text-align:left;">
34154_7_86
</td>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
381605
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057939
</td>
<td style="text-align:left;">
34154_7_87
</td>
<td style="text-align:right;">
36
</td>
<td style="text-align:right;">
403059
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057940
</td>
<td style="text-align:left;">
34154_7_88
</td>
<td style="text-align:right;">
51
</td>
<td style="text-align:right;">
239958
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057941
</td>
<td style="text-align:left;">
34154_7_89
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
406592
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057942
</td>
<td style="text-align:left;">
34154_7_90
</td>
<td style="text-align:right;">
31
</td>
<td style="text-align:right;">
427666
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057943
</td>
<td style="text-align:left;">
34154_7_91
</td>
<td style="text-align:right;">
34
</td>
<td style="text-align:right;">
474397
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057944
</td>
<td style="text-align:left;">
34154_7_94
</td>
<td style="text-align:right;">
48
</td>
<td style="text-align:right;">
362711
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057945
</td>
<td style="text-align:left;">
34154_7_95
</td>
<td style="text-align:right;">
40
</td>
<td style="text-align:right;">
501204
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057946
</td>
<td style="text-align:left;">
34154_7_96
</td>
<td style="text-align:right;">
34
</td>
<td style="text-align:right;">
410121
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057947
</td>
<td style="text-align:left;">
34154_7_97
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
577547
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057948
</td>
<td style="text-align:left;">
34154_7_98
</td>
<td style="text-align:right;">
34
</td>
<td style="text-align:right;">
483580
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057949
</td>
<td style="text-align:left;">
34154_7_100
</td>
<td style="text-align:right;">
42
</td>
<td style="text-align:right;">
668442
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057950
</td>
<td style="text-align:left;">
34154_7_102
</td>
<td style="text-align:right;">
67
</td>
<td style="text-align:right;">
190918
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057951
</td>
<td style="text-align:left;">
34154_7_103
</td>
<td style="text-align:right;">
37
</td>
<td style="text-align:right;">
579329
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057952
</td>
<td style="text-align:left;">
34154_7_104
</td>
<td style="text-align:right;">
51
</td>
<td style="text-align:right;">
331270
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057953
</td>
<td style="text-align:left;">
34154_7_105
</td>
<td style="text-align:right;">
76
</td>
<td style="text-align:right;">
182873
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057954
</td>
<td style="text-align:left;">
34154_7_106
</td>
<td style="text-align:right;">
54
</td>
<td style="text-align:right;">
442852
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057955
</td>
<td style="text-align:left;">
34154_7_108
</td>
<td style="text-align:right;">
41
</td>
<td style="text-align:right;">
622199
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057956
</td>
<td style="text-align:left;">
34154_7_110
</td>
<td style="text-align:right;">
43
</td>
<td style="text-align:right;">
855851
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057958
</td>
<td style="text-align:left;">
34154_7_112
</td>
<td style="text-align:right;">
44
</td>
<td style="text-align:right;">
702061
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057961
</td>
<td style="text-align:left;">
34154_7_116
</td>
<td style="text-align:right;">
48
</td>
<td style="text-align:right;">
298228
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057962
</td>
<td style="text-align:left;">
34154_7_118
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
367382
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057963
</td>
<td style="text-align:left;">
34154_7_119
</td>
<td style="text-align:right;">
63
</td>
<td style="text-align:right;">
294596
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057965
</td>
<td style="text-align:left;">
34154_7_122
</td>
<td style="text-align:right;">
40
</td>
<td style="text-align:right;">
326754
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057966
</td>
<td style="text-align:left;">
34154_7_123
</td>
<td style="text-align:right;">
72
</td>
<td style="text-align:right;">
208170
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057968
</td>
<td style="text-align:left;">
34154_7_125
</td>
<td style="text-align:right;">
27
</td>
<td style="text-align:right;">
630789
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057971
</td>
<td style="text-align:left;">
34154_7_130
</td>
<td style="text-align:right;">
57
</td>
<td style="text-align:right;">
262748
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057972
</td>
<td style="text-align:left;">
34154_7_131
</td>
<td style="text-align:right;">
34
</td>
<td style="text-align:right;">
602457
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057975
</td>
<td style="text-align:left;">
34154_7_134
</td>
<td style="text-align:right;">
66
</td>
<td style="text-align:right;">
363110
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057976
</td>
<td style="text-align:left;">
34154_7_136
</td>
<td style="text-align:right;">
58
</td>
<td style="text-align:right;">
280266
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057977
</td>
<td style="text-align:left;">
34154_7_138
</td>
<td style="text-align:right;">
58
</td>
<td style="text-align:right;">
222947
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057979
</td>
<td style="text-align:left;">
34154_7_140
</td>
<td style="text-align:right;">
34
</td>
<td style="text-align:right;">
794807
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057981
</td>
<td style="text-align:left;">
34154_7_142
</td>
<td style="text-align:right;">
29
</td>
<td style="text-align:right;">
424807
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057982
</td>
<td style="text-align:left;">
34154_7_144
</td>
<td style="text-align:right;">
67
</td>
<td style="text-align:right;">
209137
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057983
</td>
<td style="text-align:left;">
34154_7_146
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
630958
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057985
</td>
<td style="text-align:left;">
34154_7_148
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:right;">
397227
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057986
</td>
<td style="text-align:left;">
34154_7_150
</td>
<td style="text-align:right;">
218
</td>
<td style="text-align:right;">
185957
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057988
</td>
<td style="text-align:left;">
34154_7_152
</td>
<td style="text-align:right;">
39
</td>
<td style="text-align:right;">
424465
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057989
</td>
<td style="text-align:left;">
34154_7_153
</td>
<td style="text-align:right;">
126
</td>
<td style="text-align:right;">
103010
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057991
</td>
<td style="text-align:left;">
34154_7_155
</td>
<td style="text-align:right;">
36
</td>
<td style="text-align:right;">
720261
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057992
</td>
<td style="text-align:left;">
34154_7_158
</td>
<td style="text-align:right;">
63
</td>
<td style="text-align:right;">
266644
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057994
</td>
<td style="text-align:left;">
34154_7_160
</td>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
358687
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057996
</td>
<td style="text-align:left;">
34154_7_162
</td>
<td style="text-align:right;">
40
</td>
<td style="text-align:right;">
584309
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057997
</td>
<td style="text-align:left;">
34154_7_164
</td>
<td style="text-align:right;">
58
</td>
<td style="text-align:right;">
326092
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6057998
</td>
<td style="text-align:left;">
34154_7_166
</td>
<td style="text-align:right;">
57
</td>
<td style="text-align:right;">
197588
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058000
</td>
<td style="text-align:left;">
34154_7_168
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
713824
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058003
</td>
<td style="text-align:left;">
34154_7_172
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
380055
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058004
</td>
<td style="text-align:left;">
34154_7_174
</td>
<td style="text-align:right;">
71
</td>
<td style="text-align:right;">
185030
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058006
</td>
<td style="text-align:left;">
34154_7_176
</td>
<td style="text-align:right;">
183
</td>
<td style="text-align:right;">
363131
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058008
</td>
<td style="text-align:left;">
34154_7_178
</td>
<td style="text-align:right;">
38
</td>
<td style="text-align:right;">
396979
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058009
</td>
<td style="text-align:left;">
34154_7_179
</td>
<td style="text-align:right;">
78
</td>
<td style="text-align:right;">
274664
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058011
</td>
<td style="text-align:left;">
34154_7_183
</td>
<td style="text-align:right;">
66
</td>
<td style="text-align:right;">
159382
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058012
</td>
<td style="text-align:left;">
34154_7_184
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
1457444
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058013
</td>
<td style="text-align:left;">
34154_7_185
</td>
<td style="text-align:right;">
57
</td>
<td style="text-align:right;">
333184
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058016
</td>
<td style="text-align:left;">
34154_7_189
</td>
<td style="text-align:right;">
47
</td>
<td style="text-align:right;">
715588
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058018
</td>
<td style="text-align:left;">
34154_7_191
</td>
<td style="text-align:right;">
81
</td>
<td style="text-align:right;">
188298
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058019
</td>
<td style="text-align:left;">
34154_7_194
</td>
<td style="text-align:right;">
78
</td>
<td style="text-align:right;">
204640
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058022
</td>
<td style="text-align:left;">
34154_7_197
</td>
<td style="text-align:right;">
31
</td>
<td style="text-align:right;">
428941
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058024
</td>
<td style="text-align:left;">
34154_7_199
</td>
<td style="text-align:right;">
102
</td>
<td style="text-align:right;">
170378
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058025
</td>
<td style="text-align:left;">
34154_7_202
</td>
<td style="text-align:right;">
82
</td>
<td style="text-align:right;">
158603
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058027
</td>
<td style="text-align:left;">
34154_7_204
</td>
<td style="text-align:right;">
33
</td>
<td style="text-align:right;">
713297
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058028
</td>
<td style="text-align:left;">
34154_7_205
</td>
<td style="text-align:right;">
128
</td>
<td style="text-align:right;">
94969
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058030
</td>
<td style="text-align:left;">
34154_7_207
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
268948
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058031
</td>
<td style="text-align:left;">
34154_7_210
</td>
<td style="text-align:right;">
46
</td>
<td style="text-align:right;">
383706
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058033
</td>
<td style="text-align:left;">
34154_7_212
</td>
<td style="text-align:right;">
68
</td>
<td style="text-align:right;">
238327
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058034
</td>
<td style="text-align:left;">
34154_7_213
</td>
<td style="text-align:right;">
34
</td>
<td style="text-align:right;">
367714
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058036
</td>
<td style="text-align:left;">
34154_7_216
</td>
<td style="text-align:right;">
34
</td>
<td style="text-align:right;">
817205
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058038
</td>
<td style="text-align:left;">
34154_7_218
</td>
<td style="text-align:right;">
202
</td>
<td style="text-align:right;">
580601
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058039
</td>
<td style="text-align:left;">
34154_7_219
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
463964
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058040
</td>
<td style="text-align:left;">
34154_7_221
</td>
<td style="text-align:right;">
83
</td>
<td style="text-align:right;">
194692
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058042
</td>
<td style="text-align:left;">
34154_7_224
</td>
<td style="text-align:right;">
41
</td>
<td style="text-align:right;">
380637
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058044
</td>
<td style="text-align:left;">
34154_7_226
</td>
<td style="text-align:right;">
36
</td>
<td style="text-align:right;">
579329
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058045
</td>
<td style="text-align:left;">
34154_7_227
</td>
<td style="text-align:right;">
43
</td>
<td style="text-align:right;">
405607
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058047
</td>
<td style="text-align:left;">
34154_7_231
</td>
<td style="text-align:right;">
97
</td>
<td style="text-align:right;">
185528
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058048
</td>
<td style="text-align:left;">
34154_7_232
</td>
<td style="text-align:right;">
41
</td>
<td style="text-align:right;">
433954
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058050
</td>
<td style="text-align:left;">
34154_7_234
</td>
<td style="text-align:right;">
37
</td>
<td style="text-align:right;">
512304
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058051
</td>
<td style="text-align:left;">
34154_7_235
</td>
<td style="text-align:right;">
77
</td>
<td style="text-align:right;">
270793
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058053
</td>
<td style="text-align:left;">
34154_7_239
</td>
<td style="text-align:right;">
55
</td>
<td style="text-align:right;">
222947
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058054
</td>
<td style="text-align:left;">
34154_7_240
</td>
<td style="text-align:right;">
65
</td>
<td style="text-align:right;">
209516
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058056
</td>
<td style="text-align:left;">
34154_7_242
</td>
<td style="text-align:right;">
68
</td>
<td style="text-align:right;">
362712
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058059
</td>
<td style="text-align:left;">
34154_7_247
</td>
<td style="text-align:right;">
99
</td>
<td style="text-align:right;">
171469
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058060
</td>
<td style="text-align:left;">
34154_7_248
</td>
<td style="text-align:right;">
44
</td>
<td style="text-align:right;">
431267
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058061
</td>
<td style="text-align:left;">
34154_7_249
</td>
<td style="text-align:right;">
34
</td>
<td style="text-align:right;">
698084
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058063
</td>
<td style="text-align:left;">
34154_7_252
</td>
<td style="text-align:right;">
46
</td>
<td style="text-align:right;">
715600
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058065
</td>
<td style="text-align:left;">
34154_7_254
</td>
<td style="text-align:right;">
36
</td>
<td style="text-align:right;">
529663
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058066
</td>
<td style="text-align:left;">
34154_7_255
</td>
<td style="text-align:right;">
41
</td>
<td style="text-align:right;">
405560
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058068
</td>
<td style="text-align:left;">
34154_7_259
</td>
<td style="text-align:right;">
72
</td>
<td style="text-align:right;">
333667
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058069
</td>
<td style="text-align:left;">
34154_7_260
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:right;">
630957
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058071
</td>
<td style="text-align:left;">
34154_7_262
</td>
<td style="text-align:right;">
53
</td>
<td style="text-align:right;">
326092
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058072
</td>
<td style="text-align:left;">
34154_7_263
</td>
<td style="text-align:right;">
37
</td>
<td style="text-align:right;">
437143
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058074
</td>
<td style="text-align:left;">
34154_7_267
</td>
<td style="text-align:right;">
34
</td>
<td style="text-align:right;">
643697
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058075
</td>
<td style="text-align:left;">
34154_7_268
</td>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
292764
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058076
</td>
<td style="text-align:left;">
34154_7_269
</td>
<td style="text-align:right;">
46
</td>
<td style="text-align:right;">
371971
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058078
</td>
<td style="text-align:left;">
34154_7_271
</td>
<td style="text-align:right;">
48
</td>
<td style="text-align:right;">
448219
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058079
</td>
<td style="text-align:left;">
34154_7_274
</td>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
356539
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058081
</td>
<td style="text-align:left;">
34154_7_276
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
609308
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058082
</td>
<td style="text-align:left;">
34154_7_277
</td>
<td style="text-align:right;">
44
</td>
<td style="text-align:right;">
351289
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058083
</td>
<td style="text-align:left;">
34154_7_279
</td>
<td style="text-align:right;">
36
</td>
<td style="text-align:right;">
510163
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058085
</td>
<td style="text-align:left;">
34154_7_281
</td>
<td style="text-align:right;">
48
</td>
<td style="text-align:right;">
393764
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058087
</td>
<td style="text-align:left;">
34154_7_283
</td>
<td style="text-align:right;">
41
</td>
<td style="text-align:right;">
362707
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058089
</td>
<td style="text-align:left;">
34154_7_287
</td>
<td style="text-align:right;">
108
</td>
<td style="text-align:right;">
164351
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058091
</td>
<td style="text-align:left;">
34154_7_289
</td>
<td style="text-align:right;">
34
</td>
<td style="text-align:right;">
510807
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058093
</td>
<td style="text-align:left;">
34154_7_291
</td>
<td style="text-align:right;">
31
</td>
<td style="text-align:right;">
365644
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058094
</td>
<td style="text-align:left;">
34154_7_294
</td>
<td style="text-align:right;">
29
</td>
<td style="text-align:right;">
915814
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058096
</td>
<td style="text-align:left;">
34154_7_296
</td>
<td style="text-align:right;">
42
</td>
<td style="text-align:right;">
280593
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058098
</td>
<td style="text-align:left;">
34154_7_298
</td>
<td style="text-align:right;">
79
</td>
<td style="text-align:right;">
189067
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058099
</td>
<td style="text-align:left;">
34154_7_299
</td>
<td style="text-align:right;">
73
</td>
<td style="text-align:right;">
184552
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058101
</td>
<td style="text-align:left;">
34154_7_303
</td>
<td style="text-align:right;">
36
</td>
<td style="text-align:right;">
969325
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058102
</td>
<td style="text-align:left;">
34154_7_304
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
1004795
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058103
</td>
<td style="text-align:left;">
34154_7_306
</td>
<td style="text-align:right;">
43
</td>
<td style="text-align:right;">
358237
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058104
</td>
<td style="text-align:left;">
34154_7_307
</td>
<td style="text-align:right;">
82
</td>
<td style="text-align:right;">
186567
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058106
</td>
<td style="text-align:left;">
34154_7_312
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
632067
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058107
</td>
<td style="text-align:left;">
34154_7_313
</td>
<td style="text-align:right;">
72
</td>
<td style="text-align:right;">
180607
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058108
</td>
<td style="text-align:left;">
34154_7_316
</td>
<td style="text-align:right;">
42
</td>
<td style="text-align:right;">
497931
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058109
</td>
<td style="text-align:left;">
34154_7_317
</td>
<td style="text-align:right;">
33
</td>
<td style="text-align:right;">
375860
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058110
</td>
<td style="text-align:left;">
34154_7_318
</td>
<td style="text-align:right;">
54
</td>
<td style="text-align:right;">
280266
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058111
</td>
<td style="text-align:left;">
34154_7_322
</td>
<td style="text-align:right;">
288
</td>
<td style="text-align:right;">
532790
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058112
</td>
<td style="text-align:left;">
34154_7_323
</td>
<td style="text-align:right;">
33
</td>
<td style="text-align:right;">
467932
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058113
</td>
<td style="text-align:left;">
34154_7_324
</td>
<td style="text-align:right;">
46
</td>
<td style="text-align:right;">
388030
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058114
</td>
<td style="text-align:left;">
34154_7_325
</td>
<td style="text-align:right;">
55
</td>
<td style="text-align:right;">
378141
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058115
</td>
<td style="text-align:left;">
34154_7_330
</td>
<td style="text-align:right;">
85
</td>
<td style="text-align:right;">
184786
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058116
</td>
<td style="text-align:left;">
34154_7_331
</td>
<td style="text-align:right;">
38
</td>
<td style="text-align:right;">
549144
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058117
</td>
<td style="text-align:left;">
34154_7_332
</td>
<td style="text-align:right;">
27
</td>
<td style="text-align:right;">
1346685
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058118
</td>
<td style="text-align:left;">
34154_7_333
</td>
<td style="text-align:right;">
53
</td>
<td style="text-align:right;">
326092
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058119
</td>
<td style="text-align:left;">
34154_7_338
</td>
<td style="text-align:right;">
62
</td>
<td style="text-align:right;">
276747
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058120
</td>
<td style="text-align:left;">
34154_7_339
</td>
<td style="text-align:right;">
54
</td>
<td style="text-align:right;">
325458
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058121
</td>
<td style="text-align:left;">
34154_7_340
</td>
<td style="text-align:right;">
57
</td>
<td style="text-align:right;">
472254
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058122
</td>
<td style="text-align:left;">
34154_7_343
</td>
<td style="text-align:right;">
44
</td>
<td style="text-align:right;">
339454
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058123
</td>
<td style="text-align:left;">
34154_7_344
</td>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
357212
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058124
</td>
<td style="text-align:left;">
34154_7_345
</td>
<td style="text-align:right;">
219
</td>
<td style="text-align:right;">
170780
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058125
</td>
<td style="text-align:left;">
34154_7_348
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:right;">
407535
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058126
</td>
<td style="text-align:left;">
34154_7_351
</td>
<td style="text-align:right;">
53
</td>
<td style="text-align:right;">
1106021
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058127
</td>
<td style="text-align:left;">
34154_7_352
</td>
<td style="text-align:right;">
37
</td>
<td style="text-align:right;">
576128
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058128
</td>
<td style="text-align:left;">
34154_7_353
</td>
<td style="text-align:right;">
41
</td>
<td style="text-align:right;">
355308
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058130
</td>
<td style="text-align:left;">
34154_7_359
</td>
<td style="text-align:right;">
38
</td>
<td style="text-align:right;">
1063606
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058131
</td>
<td style="text-align:left;">
34154_7_360
</td>
<td style="text-align:right;">
29
</td>
<td style="text-align:right;">
630096
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058132
</td>
<td style="text-align:left;">
34154_7_361
</td>
<td style="text-align:right;">
47
</td>
<td style="text-align:right;">
361623
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058133
</td>
<td style="text-align:left;">
34154_7_366
</td>
<td style="text-align:right;">
46
</td>
<td style="text-align:right;">
512621
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058134
</td>
<td style="text-align:left;">
34154_7_367
</td>
<td style="text-align:right;">
43
</td>
<td style="text-align:right;">
289129
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058135
</td>
<td style="text-align:left;">
34154_7_368
</td>
<td style="text-align:right;">
59
</td>
<td style="text-align:right;">
290816
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058136
</td>
<td style="text-align:left;">
34154_7_369
</td>
<td style="text-align:right;">
43
</td>
<td style="text-align:right;">
328154
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058137
</td>
<td style="text-align:left;">
34154_7_374
</td>
<td style="text-align:right;">
34
</td>
<td style="text-align:right;">
465751
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058138
</td>
<td style="text-align:left;">
34154_7_375
</td>
<td style="text-align:right;">
48
</td>
<td style="text-align:right;">
280704
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058139
</td>
<td style="text-align:left;">
34154_7_376
</td>
<td style="text-align:right;">
28
</td>
<td style="text-align:right;">
377740
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058140
</td>
<td style="text-align:left;">
34154_7_378
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
668781
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058141
</td>
<td style="text-align:left;">
34154_7_379
</td>
<td style="text-align:right;">
27
</td>
<td style="text-align:right;">
371955
</td>
</tr>
<tr>
<td style="text-align:left;">
ERR6058142
</td>
<td style="text-align:left;">
34154_7_380
</td>
<td style="text-align:right;">
58
</td>
<td style="text-align:right;">
312639
</td>
</tr>
</tbody>
</table>
</div>
<div id="mlst-k-and-o-loci" class="section level2">
<h2 class="hasAnchor">
<a href="#mlst-k-and-o-loci" class="anchor"></a>MLST, K and O loci</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">btESBL_sequence_sample_metadata</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"Klebsiella"</span>, <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename_with</a></span><span class="op">(</span><span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"kleb_"</span>, <span class="st">""</span>, <span class="va">.x</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename_with</a></span><span class="op">(</span><span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"k_locus"</span>, <span class="st">"K_locus"</span>, <span class="va">.x</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename_with</a></span><span class="op">(</span><span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"o_locus"</span>, <span class="st">"O_locus"</span>, <span class="va">.x</span><span class="op">)</span><span class="op">)</span>  <span class="op">-&gt;</span>
  <span class="va">dassimKleb_BTKleb.diversity</span>
  
<span class="va">dassimKleb_BTKleb.diversity</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">ST</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>,
         ST <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"ST"</span>,<span class="va">ST</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">n</span> <span class="op">&gt;</span> <span class="fl">1</span>, <span class="va">ST</span> <span class="op">!=</span> <span class="st">"STNovel"</span><span class="op">)</span> <span class="op">%&gt;%</span>  
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_inorder.html">fct_infreq</a></span><span class="op">(</span><span class="va">ST</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_bar</span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/viridis_pal.html">viridis_pal</a></span><span class="op">(</span><span class="op">)</span><span class="op">(</span><span class="fl">4</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">coord_flip</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Number"</span>, x <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span>  <span class="op">-&gt;</span> <span class="va">a</span>

<span class="va">dassimKleb_BTKleb.diversity</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>K_locus <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span>
    <span class="va">K_locus_confidence</span> <span class="op">%in%</span> 
           <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Good"</span>,
             <span class="st">"High"</span>,             
             <span class="st">"Very high"</span><span class="op">)</span> <span class="op">~</span> <span class="va">K_locus</span>,
    <span class="cn">TRUE</span> <span class="op">~</span> <span class="st">"Unknown"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">K_locus</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">n</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span>  
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_inorder.html">fct_infreq</a></span><span class="op">(</span><span class="va">K_locus</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_bar</span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/viridis_pal.html">viridis_pal</a></span><span class="op">(</span><span class="op">)</span><span class="op">(</span><span class="fl">4</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">coord_flip</span><span class="op">(</span><span class="op">)</span>  <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Number"</span>, x <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span>  <span class="op">-&gt;</span> <span class="va">b</span>

<span class="va">dassimKleb_BTKleb.diversity</span><span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>O_locus <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span>
    <span class="va">O_locus_confidence</span> <span class="op">%in%</span> 
           <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Good"</span>,
             <span class="st">"High"</span>,             
             <span class="st">"Very high"</span><span class="op">)</span> <span class="op">~</span> <span class="va">O_locus</span>,
    <span class="cn">TRUE</span> <span class="op">~</span> <span class="st">"Unknown"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">O_locus</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
 <span class="co"># filter(n &gt; 1) %&gt;%  </span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_inorder.html">fct_infreq</a></span><span class="op">(</span><span class="va">O_locus</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_bar</span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/viridis_pal.html">viridis_pal</a></span><span class="op">(</span><span class="op">)</span><span class="op">(</span><span class="fl">4</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">coord_flip</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Number"</span>, x <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span>  <span class="op">-&gt;</span> <span class="va">c</span>

<span class="co"># cum K and O serotypes</span>
<span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_rows</a></span><span class="op">(</span>
  
  <span class="va">dassimKleb_BTKleb.diversity</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">K_locus</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
      n_loci <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>,
      cum_n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>,
      cum_prop <span class="op">=</span> <span class="va">cum_n</span> <span class="op">/</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">cum_n</span><span class="op">)</span><span class="op">+</span><span class="fl">9</span><span class="op">)</span>,
      type <span class="op">=</span> <span class="st">"K-type"</span>
    <span class="op">)</span> <span class="op">%&gt;%</span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>Locus <span class="op">=</span> <span class="va">K_locus</span><span class="op">)</span>,
  
  <span class="va">dassimKleb_BTKleb.diversity</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">O_locus</span><span class="op">)</span> <span class="op">%&gt;%</span>
      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>O_locus <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span>
    <span class="va">O_locus_confidence</span> <span class="op">%in%</span> 
           <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Good"</span>,
             <span class="st">"High"</span>,             
             <span class="st">"Very high"</span><span class="op">)</span> <span class="op">~</span> <span class="va">O_locus</span>,
    <span class="cn">TRUE</span> <span class="op">~</span> <span class="st">"Unknown"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">O_locus</span> <span class="op">!=</span> <span class="st">"Unknown"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
      n_loci <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>,
      cum_n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>,
      cum_prop <span class="op">=</span> <span class="va">cum_n</span> <span class="op">/</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">cum_n</span><span class="op">)</span><span class="op">+</span><span class="fl">6</span><span class="op">)</span>,     <span class="co"># fudge for unknown O tyoe</span>
      type <span class="op">=</span> <span class="st">"O-type"</span>
    <span class="op">)</span> <span class="op">%&gt;%</span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>Locus <span class="op">=</span> <span class="va">O_locus</span><span class="op">)</span>,
  
  <span class="va">dassimKleb_BTKleb.diversity</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">ST</span> <span class="op">!=</span> <span class="st">"Novel"</span><span class="op">)</span>  <span class="op">%&gt;%</span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">ST</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
      n_loci <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>,
      cum_n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>,
      cum_prop <span class="op">=</span> <span class="va">cum_n</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">cum_n</span><span class="op">)</span>,
      type <span class="op">=</span> <span class="st">"ST"</span>
    <span class="op">)</span> <span class="op">%&gt;%</span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>Locus <span class="op">=</span> <span class="va">ST</span><span class="op">)</span>
<span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">type</span>, levels <span class="op">=</span> 
                         <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"O-type"</span>,
                           <span class="st">"K-type"</span>,
                           <span class="st">"ST"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">n_loci</span>, <span class="va">cum_prop</span>, color <span class="op">=</span> <span class="va">type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/viridis_pal.html">viridis_pal</a></span><span class="op">(</span><span class="op">)</span><span class="op">(</span><span class="fl">4</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>x<span class="op">=</span> <span class="st">"Number of K/O-type/ST"</span>, y <span class="op">=</span> <span class="st">"Cum. prevalence"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">d</span>

<span class="va">dassimKleb_BTKleb.diversity</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>O_locus <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span>
    <span class="va">O_locus_confidence</span> <span class="op">%in%</span> 
           <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Good"</span>,
             <span class="st">"High"</span>,             
             <span class="st">"Very high"</span><span class="op">)</span> <span class="op">~</span> <span class="va">O_locus</span>,
    <span class="cn">TRUE</span> <span class="op">~</span> <span class="st">"Unknown"</span><span class="op">)</span>,
    ST <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"ST"</span>, <span class="va">ST</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">ST</span> <span class="op">!=</span> <span class="st">"STNovel"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">ST</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">n</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>O_locus <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_inorder.html">fct_infreq</a></span><span class="op">(</span><span class="va">O_locus</span><span class="op">)</span>,
         ST <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_inorder.html">fct_infreq</a></span><span class="op">(</span><span class="va">ST</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">O_locus</span>, <span class="va">ST</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">ST</span>,<span class="va">O_locus</span>, size <span class="op">=</span> <span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/viridis_pal.html">viridis_pal</a></span><span class="op">(</span><span class="op">)</span><span class="op">(</span><span class="fl">4</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"O-type"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,
        legend.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">e</span>
<span class="co">#&gt; `summarise()` has grouped output by 'O_locus'. You can override using the `.groups` argument.</span>

<span class="va">dassimKleb_BTKleb.diversity</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>K_locus <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span>
    <span class="va">K_locus_confidence</span> <span class="op">%in%</span> 
           <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Good"</span>,
             <span class="st">"High"</span>,             
             <span class="st">"Very high"</span><span class="op">)</span> <span class="op">~</span> <span class="va">K_locus</span>,
    <span class="cn">TRUE</span> <span class="op">~</span> <span class="st">"Unknown"</span><span class="op">)</span>,
    ST <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"ST"</span>, <span class="va">ST</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">ST</span> <span class="op">!=</span> <span class="st">"STNovel"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">ST</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">n</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>K_locus <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_inorder.html">fct_infreq</a></span><span class="op">(</span><span class="va">K_locus</span><span class="op">)</span>,
         ST <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_inorder.html">fct_infreq</a></span><span class="op">(</span><span class="va">ST</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">K_locus</span>, <span class="va">ST</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">ST</span>,<span class="va">K_locus</span>, size <span class="op">=</span> <span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/viridis_pal.html">viridis_pal</a></span><span class="op">(</span><span class="op">)</span><span class="op">(</span><span class="fl">4</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"K-type"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,
        legend.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_size</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">10</span>,<span class="fl">15</span><span class="op">)</span><span class="op">)</span><span class="op">-&gt;</span> <span class="va">f</span>
<span class="co">#&gt; `summarise()` has grouped output by 'K_locus'. You can override using the `.groups` argument.</span>



<span class="op">(</span><span class="op">(</span><span class="va">a</span> <span class="op">+</span> <span class="va">b</span> <span class="op">+</span> <span class="op">(</span><span class="va">c</span> <span class="op">/</span> <span class="va">d</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="va">e</span> <span class="op">/</span> <span class="va">f</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html">plot_layout</a></span><span class="op">(</span>heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>  <span class="op">+</span> 
  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_annotation.html">plot_annotation</a></span><span class="op">(</span>tag_levels <span class="op">=</span> <span class="st">"A"</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">stplot</span>
<span class="va">stplot</span></code></pre></div>
<div class="figure">
<img src="analysis-kleb_files/figure-html/mlst-1.png" alt="FIGURE X: Diversity of Klebsiella chromasomal sequence type (ST, A), K-type (B) and O-type (C). (D) shows cumulative prevalence for ST, K-type and O-types for all isolates in the collection as a function of the number of K-types, O-types, or STs, with each category ordered in size from largest to smallest. (E) and (F) show ST association of O-type and K-type respectively, where area of point is proportional to number of samples in the study. STs with only a single representative in the collection are excluded from plots A, B, C,E, F." width="768"><p class="caption">
FIGURE X: Diversity of Klebsiella chromasomal sequence type (ST, A), K-type (B) and O-type (C). (D) shows cumulative prevalence for ST, K-type and O-types for all isolates in the collection as a function of the number of K-types, O-types, or STs, with each category ordered in size from largest to smallest. (E) and (F) show ST association of O-type and K-type respectively, where area of point is proportional to number of samples in the study. STs with only a single representative in the collection are excluded from plots A, B, C,E, F.
</p>
</div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="kw">if</span> <span class="op">(</span><span class="va">write_figs</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span><span class="op">(</span>
    filename <span class="op">=</span> <span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"figures/kleb-genomics/F1_stplot.svg"</span><span class="op">)</span>,
    plot <span class="op">=</span> <span class="va">stplot</span>,
    width <span class="op">=</span> <span class="fl">8</span>,
    height <span class="op">=</span> <span class="fl">11</span>
    
  <span class="op">)</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span><span class="op">(</span>
    filename <span class="op">=</span> <span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"figures/kleb-genomics/F1_stplot.pdf"</span><span class="op">)</span>,
    plot <span class="op">=</span> <span class="va">stplot</span>,
    width <span class="op">=</span> <span class="fl">8</span>,
    height <span class="op">=</span> <span class="fl">11</span>
  <span class="op">)</span>
<span class="op">}</span>

 </code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R">

<span class="va">dassimKleb_BTKleb.diversity</span> <span class="op">%&gt;%</span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>O_locus <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span>
        <span class="va">O_locus_confidence</span> <span class="op">%in%</span> 
            <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Good"</span>,
              <span class="st">"High"</span>,             
              <span class="st">"Very high"</span><span class="op">)</span> <span class="op">~</span> <span class="va">O_locus</span>,
        <span class="cn">TRUE</span> <span class="op">~</span> <span class="st">"Unknown"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">O_locus</span><span class="op">)</span> <span class="op">%&gt;%</span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>csum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">n</span>, <span class="st">" ("</span>, <span class="fu">sp_dc</span><span class="op">(</span><span class="fl">100</span><span class="op">*</span><span class="va">n</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">csum</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span>,<span class="st">"%)"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>prop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">csum</span>, <span class="st">" ("</span>, <span class="fu">sp_dc</span><span class="op">(</span><span class="fl">100</span><span class="op">*</span><span class="va">csum</span> <span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">csum</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span>, <span class="st">"%)"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">O_locus</span>, <span class="va">n</span>, <span class="va">prop</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kbl.html">kbl</a></span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"O-types of carriage isolates"</span>,
      col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"O-type"</span>,
                    <span class="st">"n (%)"</span>,
                    <span class="st">"Cumulative n (%)"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_classic.html">kable_classic</a></span><span class="op">(</span>full_width <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<table class="table  lightable-classic">
<caption>
O-types of carriage isolates
</caption>
<thead><tr>
<th style="text-align:left;">
O-type
</th>
<th style="text-align:left;">
n (%)
</th>
<th style="text-align:left;">
Cumulative n (%)
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
O1v1
</td>
<td style="text-align:left;">
60 (29.6%)
</td>
<td style="text-align:left;">
60 (29.6%)
</td>
</tr>
<tr>
<td style="text-align:left;">
O2v2
</td>
<td style="text-align:left;">
30 (14.8%)
</td>
<td style="text-align:left;">
90 (44.3%)
</td>
</tr>
<tr>
<td style="text-align:left;">
O1v2
</td>
<td style="text-align:left;">
29 (14.3%)
</td>
<td style="text-align:left;">
119 (58.6%)
</td>
</tr>
<tr>
<td style="text-align:left;">
O4
</td>
<td style="text-align:left;">
29 (14.3%)
</td>
<td style="text-align:left;">
148 (72.9%)
</td>
</tr>
<tr>
<td style="text-align:left;">
O3b
</td>
<td style="text-align:left;">
16 (7.9%)
</td>
<td style="text-align:left;">
164 (80.8%)
</td>
</tr>
<tr>
<td style="text-align:left;">
O2v1
</td>
<td style="text-align:left;">
13 (6.4%)
</td>
<td style="text-align:left;">
177 (87.2%)
</td>
</tr>
<tr>
<td style="text-align:left;">
O5
</td>
<td style="text-align:left;">
6 (3.0%)
</td>
<td style="text-align:left;">
183 (90.1%)
</td>
</tr>
<tr>
<td style="text-align:left;">
OL101
</td>
<td style="text-align:left;">
6 (3.0%)
</td>
<td style="text-align:left;">
189 (93.1%)
</td>
</tr>
<tr>
<td style="text-align:left;">
OL103
</td>
<td style="text-align:left;">
6 (3.0%)
</td>
<td style="text-align:left;">
195 (96.1%)
</td>
</tr>
<tr>
<td style="text-align:left;">
Unknown
</td>
<td style="text-align:left;">
6 (3.0%)
</td>
<td style="text-align:left;">
201 (99.0%)
</td>
</tr>
<tr>
<td style="text-align:left;">
O12
</td>
<td style="text-align:left;">
1 (0.5%)
</td>
<td style="text-align:left;">
202 (99.5%)
</td>
</tr>
<tr>
<td style="text-align:left;">
OL104
</td>
<td style="text-align:left;">
1 (0.5%)
</td>
<td style="text-align:left;">
203 (100.0%)
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">dassimKleb_BTKleb.diversity</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>K_locus <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span>
    <span class="va">K_locus_confidence</span> <span class="op">%in%</span>
      <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Good"</span>,
        <span class="st">"High"</span>,
        <span class="st">"Very high"</span><span class="op">)</span> <span class="op">~</span> <span class="va">K_locus</span>,
    <span class="cn">TRUE</span> <span class="op">~</span> <span class="st">"Unknown"</span>
  <span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">K_locus</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>csum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">n</span>, <span class="st">" ("</span>, <span class="fu">sp_dc</span><span class="op">(</span><span class="fl">100</span> <span class="op">*</span> <span class="va">n</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">csum</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"%)"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>prop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">csum</span>, <span class="st">" ("</span>, <span class="fu">sp_dc</span><span class="op">(</span><span class="fl">100</span> <span class="op">*</span> <span class="va">csum</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">csum</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"%)"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">K_locus</span>, <span class="va">n</span>, <span class="va">prop</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kbl.html">kbl</a></span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"K-types of carriage isolates"</span>,
      col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"K-type"</span>,
                    <span class="st">"n (%)"</span>,
                    <span class="st">"Cumulative n (%)"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_classic.html">kable_classic</a></span><span class="op">(</span>full_width <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<table class="table  lightable-classic">
<caption>
K-types of carriage isolates
</caption>
<thead><tr>
<th style="text-align:left;">
K-type
</th>
<th style="text-align:left;">
n (%)
</th>
<th style="text-align:left;">
Cumulative n (%)
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
KL2
</td>
<td style="text-align:left;">
23 (11.3%)
</td>
<td style="text-align:left;">
23 (11.3%)
</td>
</tr>
<tr>
<td style="text-align:left;">
KL102
</td>
<td style="text-align:left;">
19 (9.4%)
</td>
<td style="text-align:left;">
42 (20.7%)
</td>
</tr>
<tr>
<td style="text-align:left;">
KL15
</td>
<td style="text-align:left;">
13 (6.4%)
</td>
<td style="text-align:left;">
55 (27.1%)
</td>
</tr>
<tr>
<td style="text-align:left;">
KL25
</td>
<td style="text-align:left;">
12 (5.9%)
</td>
<td style="text-align:left;">
67 (33.0%)
</td>
</tr>
<tr>
<td style="text-align:left;">
KL111
</td>
<td style="text-align:left;">
11 (5.4%)
</td>
<td style="text-align:left;">
78 (38.4%)
</td>
</tr>
<tr>
<td style="text-align:left;">
Unknown
</td>
<td style="text-align:left;">
9 (4.4%)
</td>
<td style="text-align:left;">
87 (42.9%)
</td>
</tr>
<tr>
<td style="text-align:left;">
KL149
</td>
<td style="text-align:left;">
8 (3.9%)
</td>
<td style="text-align:left;">
95 (46.8%)
</td>
</tr>
<tr>
<td style="text-align:left;">
KL30
</td>
<td style="text-align:left;">
8 (3.9%)
</td>
<td style="text-align:left;">
103 (50.7%)
</td>
</tr>
<tr>
<td style="text-align:left;">
KL16
</td>
<td style="text-align:left;">
7 (3.4%)
</td>
<td style="text-align:left;">
110 (54.2%)
</td>
</tr>
<tr>
<td style="text-align:left;">
KL24
</td>
<td style="text-align:left;">
7 (3.4%)
</td>
<td style="text-align:left;">
117 (57.6%)
</td>
</tr>
<tr>
<td style="text-align:left;">
KL10
</td>
<td style="text-align:left;">
6 (3.0%)
</td>
<td style="text-align:left;">
123 (60.6%)
</td>
</tr>
<tr>
<td style="text-align:left;">
KL17
</td>
<td style="text-align:left;">
6 (3.0%)
</td>
<td style="text-align:left;">
129 (63.5%)
</td>
</tr>
<tr>
<td style="text-align:left;">
KL57
</td>
<td style="text-align:left;">
6 (3.0%)
</td>
<td style="text-align:left;">
135 (66.5%)
</td>
</tr>
<tr>
<td style="text-align:left;">
KL112
</td>
<td style="text-align:left;">
5 (2.5%)
</td>
<td style="text-align:left;">
140 (69.0%)
</td>
</tr>
<tr>
<td style="text-align:left;">
KL23
</td>
<td style="text-align:left;">
5 (2.5%)
</td>
<td style="text-align:left;">
145 (71.4%)
</td>
</tr>
<tr>
<td style="text-align:left;">
KL27
</td>
<td style="text-align:left;">
5 (2.5%)
</td>
<td style="text-align:left;">
150 (73.9%)
</td>
</tr>
<tr>
<td style="text-align:left;">
KL110
</td>
<td style="text-align:left;">
4 (2.0%)
</td>
<td style="text-align:left;">
154 (75.9%)
</td>
</tr>
<tr>
<td style="text-align:left;">
KL48
</td>
<td style="text-align:left;">
4 (2.0%)
</td>
<td style="text-align:left;">
158 (77.8%)
</td>
</tr>
<tr>
<td style="text-align:left;">
KL137
</td>
<td style="text-align:left;">
3 (1.5%)
</td>
<td style="text-align:left;">
161 (79.3%)
</td>
</tr>
<tr>
<td style="text-align:left;">
KL18
</td>
<td style="text-align:left;">
3 (1.5%)
</td>
<td style="text-align:left;">
164 (80.8%)
</td>
</tr>
<tr>
<td style="text-align:left;">
KL39
</td>
<td style="text-align:left;">
3 (1.5%)
</td>
<td style="text-align:left;">
167 (82.3%)
</td>
</tr>
<tr>
<td style="text-align:left;">
KL108
</td>
<td style="text-align:left;">
2 (1.0%)
</td>
<td style="text-align:left;">
169 (83.3%)
</td>
</tr>
<tr>
<td style="text-align:left;">
KL13
</td>
<td style="text-align:left;">
2 (1.0%)
</td>
<td style="text-align:left;">
171 (84.2%)
</td>
</tr>
<tr>
<td style="text-align:left;">
KL136
</td>
<td style="text-align:left;">
2 (1.0%)
</td>
<td style="text-align:left;">
173 (85.2%)
</td>
</tr>
<tr>
<td style="text-align:left;">
KL151
</td>
<td style="text-align:left;">
2 (1.0%)
</td>
<td style="text-align:left;">
175 (86.2%)
</td>
</tr>
<tr>
<td style="text-align:left;">
KL155
</td>
<td style="text-align:left;">
2 (1.0%)
</td>
<td style="text-align:left;">
177 (87.2%)
</td>
</tr>
<tr>
<td style="text-align:left;">
KL21
</td>
<td style="text-align:left;">
2 (1.0%)
</td>
<td style="text-align:left;">
179 (88.2%)
</td>
</tr>
<tr>
<td style="text-align:left;">
KL54
</td>
<td style="text-align:left;">
2 (1.0%)
</td>
<td style="text-align:left;">
181 (89.2%)
</td>
</tr>
<tr>
<td style="text-align:left;">
KL63
</td>
<td style="text-align:left;">
2 (1.0%)
</td>
<td style="text-align:left;">
183 (90.1%)
</td>
</tr>
<tr>
<td style="text-align:left;">
KL67
</td>
<td style="text-align:left;">
2 (1.0%)
</td>
<td style="text-align:left;">
185 (91.1%)
</td>
</tr>
<tr>
<td style="text-align:left;">
KL8
</td>
<td style="text-align:left;">
2 (1.0%)
</td>
<td style="text-align:left;">
187 (92.1%)
</td>
</tr>
<tr>
<td style="text-align:left;">
KL103
</td>
<td style="text-align:left;">
1 (0.5%)
</td>
<td style="text-align:left;">
188 (92.6%)
</td>
</tr>
<tr>
<td style="text-align:left;">
KL105
</td>
<td style="text-align:left;">
1 (0.5%)
</td>
<td style="text-align:left;">
189 (93.1%)
</td>
</tr>
<tr>
<td style="text-align:left;">
KL114
</td>
<td style="text-align:left;">
1 (0.5%)
</td>
<td style="text-align:left;">
190 (93.6%)
</td>
</tr>
<tr>
<td style="text-align:left;">
KL115
</td>
<td style="text-align:left;">
1 (0.5%)
</td>
<td style="text-align:left;">
191 (94.1%)
</td>
</tr>
<tr>
<td style="text-align:left;">
KL12
</td>
<td style="text-align:left;">
1 (0.5%)
</td>
<td style="text-align:left;">
192 (94.6%)
</td>
</tr>
<tr>
<td style="text-align:left;">
KL123
</td>
<td style="text-align:left;">
1 (0.5%)
</td>
<td style="text-align:left;">
193 (95.1%)
</td>
</tr>
<tr>
<td style="text-align:left;">
KL14
</td>
<td style="text-align:left;">
1 (0.5%)
</td>
<td style="text-align:left;">
194 (95.6%)
</td>
</tr>
<tr>
<td style="text-align:left;">
KL145
</td>
<td style="text-align:left;">
1 (0.5%)
</td>
<td style="text-align:left;">
195 (96.1%)
</td>
</tr>
<tr>
<td style="text-align:left;">
KL157
</td>
<td style="text-align:left;">
1 (0.5%)
</td>
<td style="text-align:left;">
196 (96.6%)
</td>
</tr>
<tr>
<td style="text-align:left;">
KL19
</td>
<td style="text-align:left;">
1 (0.5%)
</td>
<td style="text-align:left;">
197 (97.0%)
</td>
</tr>
<tr>
<td style="text-align:left;">
KL52
</td>
<td style="text-align:left;">
1 (0.5%)
</td>
<td style="text-align:left;">
198 (97.5%)
</td>
</tr>
<tr>
<td style="text-align:left;">
KL59
</td>
<td style="text-align:left;">
1 (0.5%)
</td>
<td style="text-align:left;">
199 (98.0%)
</td>
</tr>
<tr>
<td style="text-align:left;">
KL62
</td>
<td style="text-align:left;">
1 (0.5%)
</td>
<td style="text-align:left;">
200 (98.5%)
</td>
</tr>
<tr>
<td style="text-align:left;">
KL64
</td>
<td style="text-align:left;">
1 (0.5%)
</td>
<td style="text-align:left;">
201 (99.0%)
</td>
</tr>
<tr>
<td style="text-align:left;">
KL74
</td>
<td style="text-align:left;">
1 (0.5%)
</td>
<td style="text-align:left;">
202 (99.5%)
</td>
</tr>
<tr>
<td style="text-align:left;">
KL9
</td>
<td style="text-align:left;">
1 (0.5%)
</td>
<td style="text-align:left;">
203 (100.0%)
</td>
</tr>
</tbody>
</table>
</div>
<div id="species-and-population-structure" class="section level2">
<h2 class="hasAnchor">
<a href="#species-and-population-structure" class="anchor"></a>Species and population structure</h2>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># what species from kleborate</span>

<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">dassimKleb_BTKleb.diversity</span><span class="op">$</span><span class="va">species</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                              Klebsiella pneumoniae </span>
<span class="co">#&gt;                                                190 </span>
<span class="co">#&gt;  Klebsiella quasipneumoniae subsp. quasipneumoniae </span>
<span class="co">#&gt;                                                  2 </span>
<span class="co">#&gt; Klebsiella quasipneumoniae subsp. similipneumoniae </span>
<span class="co">#&gt;                                                  7 </span>
<span class="co">#&gt;                          Klebsiella quasivariicola </span>
<span class="co">#&gt;                                                  1 </span>
<span class="co">#&gt;              Klebsiella variicola subsp. variicola </span>
<span class="co">#&gt;                                                  3</span>
<span class="va">dassimKleb_trees.BTcarriage</span> <span class="op">&lt;-</span> <span class="va">btESBL_coregene_tree_kleb</span>


<span class="va">dassimKleb_BTKleb.diversity</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">ST</span>, <span class="va">lane</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>ST <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"ST"</span>, <span class="va">ST</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span>id_cols <span class="op">=</span> <span class="va">lane</span> ,
              names_from <span class="op">=</span> <span class="va">ST</span>, 
              values_from <span class="op">=</span> <span class="va">ST</span>,
              values_fn <span class="op">=</span> <span class="va">length</span>,
              values_fill <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>lane <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"#"</span>,<span class="st">"_"</span>, <span class="va">lane</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-&gt;</span> 
  <span class="va">mlst.onehot</span>


<span class="va">mlst.onehot</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"lane"</span>,
                <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">mlst.onehot</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, <span class="fl">2</span>, <span class="va">sum</span><span class="op">)</span>,
                           decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">]</span> <span class="op">-&gt;</span> <span class="va">mlst.onehot</span>

<span class="va">mlst.onehot</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">mlst.onehot</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, <span class="va">as.factor</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">mlst.onehot</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">mlst.onehot</span><span class="op">$</span><span class="va">lane</span>

<span class="va">dassimKleb_BTKleb.diversity</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>strain <span class="op">=</span> <span class="va">lane</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>strain <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"#"</span>,<span class="st">"_"</span>, <span class="va">strain</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">strain</span>, <span class="va">species</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-&gt;</span>
  <span class="va">spec_hm</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">spec_hm</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">spec_hm</span><span class="op">$</span><span class="va">strain</span>

<span class="fu"><a href="https://wilkelab.org/cowplot/reference/get_legend.html">get_legend</a></span><span class="op">(</span>
<span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/ggtree.html">ggtree</a></span><span class="op">(</span><span class="va">dassimKleb_trees.BTcarriage</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/gheatmap.html">gheatmap</a></span><span class="op">(</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">spec_hm</span>, <span class="va">species</span><span class="op">)</span>, 
    width <span class="op">=</span> <span class="fl">0.05</span>, 
    color <span class="op">=</span> <span class="cn">NA</span>, 
    font.size <span class="op">=</span> <span class="fl">3</span>, 
    colnames_angle <span class="op">=</span> <span class="fl">90</span>, 
    colnames_position <span class="op">=</span> <span class="st">"top"</span>, 
    colnames_offset_y <span class="op">=</span> <span class="fl">10</span>,
    offset <span class="op">=</span> <span class="fl">0.006</span> <span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span>, legend.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">ylim</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">220</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html">viridis</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">5</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="op">)</span> <span class="op">-&gt;</span> <span class="va">leg</span>
<span class="co">#&gt; Scale for 'y' is already present. Adding another scale for 'y', which will</span>
<span class="co">#&gt; replace the existing scale.</span>
<span class="co">#&gt; Scale for 'fill' is already present. Adding another scale for 'fill', which</span>
<span class="co">#&gt; will replace the existing scale.</span>

<span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/ggtree.html">ggtree</a></span><span class="op">(</span><span class="va">dassimKleb_trees.BTcarriage</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/gheatmap.html">gheatmap</a></span><span class="op">(</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">spec_hm</span>, <span class="va">species</span><span class="op">)</span> <span class="op">%&gt;%</span> 
      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>Species <span class="op">=</span> <span class="va">species</span><span class="op">)</span>, 
    width <span class="op">=</span> <span class="fl">0.05</span>, 
    color <span class="op">=</span> <span class="cn">NA</span>, 
    font.size <span class="op">=</span> <span class="fl">3</span>, 
    colnames_angle <span class="op">=</span> <span class="fl">90</span>, 
    colnames_position <span class="op">=</span> <span class="st">"top"</span>, 
    colnames_offset_y <span class="op">=</span> <span class="fl">10</span>,
    offset <span class="op">=</span> <span class="fl">0.006</span> <span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/gheatmap.html">gheatmap</a></span><span class="op">(</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">mlst.onehot</span>,<span class="op">-</span><span class="va">lane</span><span class="op">)</span>,
    width <span class="op">=</span> <span class="fl">3</span>, 
    color <span class="op">=</span> <span class="cn">NA</span>, 
    font.size <span class="op">=</span> <span class="fl">3</span>, 
    colnames_angle <span class="op">=</span> <span class="fl">90</span>, 
    colnames_position <span class="op">=</span> <span class="st">"top"</span>, 
    colnames_offset_y <span class="op">=</span> <span class="fl">10</span>,
    offset <span class="op">=</span> <span class="fl">0.05</span> 
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">ylim</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">220</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"lightgrey"</span>, <span class="st">"black"</span>, <span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html">viridis</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">5</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/geom_treescale.html">geom_treescale</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0.05</span>, y <span class="op">=</span> <span class="fl">180</span>, offset <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">-&gt;</span> 
  <span class="va">p1</span>
<span class="co">#&gt; Scale for 'fill' is already present. Adding another scale for 'fill', which</span>
<span class="co">#&gt; will replace the existing scale.</span>
<span class="co">#&gt; Scale for 'y' is already present. Adding another scale for 'y', which will</span>
<span class="co">#&gt; replace the existing scale.</span>
<span class="co">#&gt; Scale for 'fill' is already present. Adding another scale for 'fill', which</span>
<span class="co">#&gt; will replace the existing scale.</span>

<span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/ggtree.html">ggtree</a></span><span class="op">(</span><span class="fu">treeio</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/treeio/reference/tree_subset.html">tree_subset</a></span><span class="op">(</span><span class="va">dassimKleb_trees.BTcarriage</span>, <span class="fl">210</span>, levels_back <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
    <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/gheatmap.html">gheatmap</a></span><span class="op">(</span>
        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">mlst.onehot</span>,<span class="op">-</span><span class="va">lane</span><span class="op">)</span>,
        width <span class="op">=</span> <span class="fl">2</span>, 
        color <span class="op">=</span> <span class="cn">NA</span>, 
        font.size <span class="op">=</span> <span class="fl">3</span>, 
        colnames_angle <span class="op">=</span> <span class="fl">90</span>, 
        colnames_position <span class="op">=</span> <span class="st">"top"</span>, 
        colnames_offset_y <span class="op">=</span> <span class="fl">10</span>,
        offset <span class="op">=</span> <span class="fl">0</span>
    <span class="op">)</span> <span class="op">+</span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">ylim</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">205</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"lightgrey"</span>, <span class="st">"black"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/geom_treescale.html">geom_treescale</a></span><span class="op">(</span>x <span class="op">=</span><span class="fl">0.002</span>, y <span class="op">=</span> <span class="fl">180</span>, offset <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">p2</span>
<span class="co">#&gt; Scale for 'y' is already present. Adding another scale for 'y', which will</span>
<span class="co">#&gt; replace the existing scale.</span>
<span class="co">#&gt; Scale for 'fill' is already present. Adding another scale for 'fill', which</span>
<span class="co">#&gt; will replace the existing scale.</span>

<span class="op">(</span><span class="op">(</span><span class="va">p1</span> <span class="op">+</span> <span class="fu">labs</span><span class="op">(</span>tag <span class="op">=</span> <span class="st">"A"</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="va">leg</span> <span class="op">/</span> <span class="op">(</span><span class="va">p2</span> <span class="op">+</span> <span class="fu">labs</span><span class="op">(</span>tag <span class="op">=</span> <span class="st">"B"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html">plot_layout</a></span><span class="op">(</span>heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">dassim_trees</span>
  
<span class="va">dassim_trees</span></code></pre></div>
<div class="figure">
<img src="analysis-kleb_files/figure-html/dassim-tree-1.png" alt="Midpoint-rooted maximum likelihood core gene phylogeny for all samples in collection (A) and restricted to K. pneumoniae sensu stricto (B) showing chromasomal sequence types where black indicates presence and grey absence." width="1344"><p class="caption">
Midpoint-rooted maximum likelihood core gene phylogeny for all samples in collection (A) and restricted to K. pneumoniae sensu stricto (B) showing chromasomal sequence types where black indicates presence and grey absence.
</p>
</div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="kw">if</span> <span class="op">(</span><span class="va">write_figs</span><span class="op">)</span> <span class="op">{</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span><span class="op">(</span>filename <span class="op">=</span> <span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"figures/kleb-genomics/SUP_F_dassimtrees.pdf"</span><span class="op">)</span>,
       plot <span class="op">=</span> <span class="va">dassim_trees</span>,
       width <span class="op">=</span> <span class="fl">14</span>,
       height <span class="op">=</span> <span class="fl">16</span>
       
<span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span><span class="op">(</span>filename <span class="op">=</span> <span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"figures/kleb-genomics/SUP_F_dassimtrees.svg"</span><span class="op">)</span>,
       plot <span class="op">=</span> <span class="va">dassim_trees</span>,
       width <span class="op">=</span> <span class="fl">14</span>,
       height <span class="op">=</span> <span class="fl">16</span>
<span class="op">)</span>
<span class="op">}</span></code></pre></div>
</div>
<div id="amr-determinents" class="section level2">
<h2 class="hasAnchor">
<a href="#amr-determinents" class="anchor"></a>AMR determinents</h2>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># add class ro which resistnce is conferred --------------------------------</span>

<span class="va">quinolone</span> <span class="op">&lt;-</span> <span class="st">"Par|Gyr|Par|Qnr|Qep|Nor|GyrA|GyrB|ParC|ParE"</span>
<span class="va">tetracycline</span> <span class="op">&lt;-</span> <span class="st">"Tet"</span>
<span class="va">sulphonamide</span> <span class="op">&lt;-</span> <span class="st">"Sul"</span>
<span class="va">aminoglycoside</span> <span class="op">&lt;-</span> <span class="st">"Str|Aad|Aac|Aph|Rmt|APH"</span>
<span class="va">streptothricin</span> <span class="op">&lt;-</span> <span class="st">"Sat"</span>
<span class="va">macrolide</span> <span class="op">&lt;-</span> <span class="st">"Mph|Mdf|Erm|Ere"</span>
<span class="va">fosfomycin</span> <span class="op">&lt;-</span> <span class="st">"Fos"</span>
<span class="va">chloramphenicol</span> <span class="op">&lt;-</span> <span class="st">"Cat|FloR|Cml"</span>
<span class="va">trimethoprim</span> <span class="op">&lt;-</span> <span class="st">"Dfr"</span>
<span class="va">rifampicin</span> <span class="op">&lt;-</span> <span class="st">"Arr"</span>
<span class="va">ESBL</span> <span class="op">&lt;-</span> <span class="st">"SHV_12"</span>
<span class="va">penicillinase</span> <span class="op">&lt;-</span> <span class="st">"OKP|SCO|LEN|LAP|AmpC|AmpH"</span>
<span class="va">ampc</span> <span class="op">&lt;-</span> <span class="st">"CMY"</span>

<span class="va">btESBL_amrgenes</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter-joins.html">semi_join</a></span><span class="op">(</span><span class="va">dassimKleb_BTKleb.diversity</span>, 
            by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span> <span class="st">"lane"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">genus</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>gene <span class="op">=</span> <span class="va">ref_seq</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># add in QRDR mutations</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_rows</a></span><span class="op">(</span>
    <span class="va">btESBL_qrdr_mutations</span> <span class="op">%&gt;%</span> 
      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">genus</span> <span class="op">==</span> <span class="st">"K. pneumoniae complex"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">genus</span><span class="op">)</span> <span class="op">%&gt;%</span> 
      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter-joins.html">semi_join</a></span><span class="op">(</span>
        <span class="va">btESBL_CARD_qrdr_mutations</span>, 
        by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"variant"</span> <span class="op">=</span> <span class="st">"variant"</span>,
              <span class="st">"gene"</span> <span class="op">=</span>  <span class="st">"gene"</span><span class="op">)</span>
      <span class="op">)</span> <span class="op">%&gt;%</span> 
      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">gene</span>, <span class="va">lane</span><span class="op">)</span> <span class="op">%&gt;%</span> 
      <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>gene <span class="op">=</span>
               <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"(^.{1})"</span>, <span class="st">'\\U\\1'</span>,
                    <span class="va">gene</span>,
                    perl <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
      <span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"MrdA|MefB"</span>, <span class="va">gene</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="co"># AmpH|AMPH|AmpC|</span>
  <span class="co"># add in beta-lactamases</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">btESBL_NCBI_phenotypic_bl</span>, <span class="va">allele_name</span>, <span class="va">class</span><span class="op">)</span>,
    by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"gene"</span> <span class="op">=</span> <span class="st">"allele_name"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>class <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span>
    <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">gene</span>, <span class="va">quinolone</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Quinolone"</span>,
    <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">gene</span>, <span class="va">tetracycline</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Tetracycline"</span>,
    <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">gene</span>, <span class="va">sulphonamide</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Sulphonamide"</span>,
    <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">gene</span>, <span class="va">aminoglycoside</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Aminoglycoside"</span>,
    <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">gene</span>, <span class="va">streptothricin</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Streptothricin"</span>,
    <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">gene</span>, <span class="va">macrolide</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Macrolide"</span>,
    <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">gene</span>, <span class="va">fosfomycin</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Fosfomycin"</span>,
    <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">gene</span>, <span class="va">chloramphenicol</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Chloramphenicol"</span>,
    <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">gene</span>, <span class="va">rifampicin</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Rifampicin"</span>,
    <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">gene</span>,<span class="va">trimethoprim</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Trimethoprim"</span>,
    <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">gene</span>,<span class="va">ESBL</span><span class="op">)</span> <span class="op">~</span> <span class="st">"ESBL"</span>,
    <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">gene</span>,<span class="va">penicillinase</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Penicillinase"</span>,
    <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">gene</span>,<span class="va">ampc</span><span class="op">)</span> <span class="op">~</span> <span class="st">"AmpC"</span>,
    <span class="cn">TRUE</span> <span class="op">~</span> <span class="va">class</span>
  <span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>gene <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else</a></span><span class="op">(</span><span class="va">gene</span> <span class="op">==</span> <span class="st">"TEM_95"</span>,
                        <span class="st">"TEM_1"</span>,
                        <span class="va">gene</span><span class="op">)</span><span class="op">)</span> <span class="op">-&gt;</span>
  <span class="va">dassimKleb_BTKleb.amr</span> 

<span class="co"># how many genes per sample</span>

<span class="va">dassimKleb_BTKleb.amr</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">lane</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">lane</span>, <span class="va">n</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>
    min <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>,
    lq <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">0.25</span><span class="op">)</span>,
    med <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>,
    uq <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">0.75</span><span class="op">)</span>,
    max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>
  <span class="op">)</span>
<span class="co">#&gt; # A tibble: 1 × 5</span>
<span class="co">#&gt;     min    lq   med    uq   max</span>
<span class="co">#&gt;   &lt;int&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;int&gt;</span>
<span class="co">#&gt; 1     6  11.5    15    17    25</span>
    

<span class="co">### Plot overall prevalence</span>



<span class="va">dassimKleb_BTKleb.amr</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"Oqx"</span>, <span class="va">gene</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>  <span class="co"># remove efflux and intrinsic K pnemo</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">class</span><span class="op">)</span> <span class="op">%&gt;%</span>              <span class="co"># penicillinase</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>n_class <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">class</span><span class="op">)</span>,
         n_genes_in_class <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/n_distinct.html">n_distinct</a></span><span class="op">(</span><span class="va">gene</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">class</span>, <span class="va">n_class</span>, <span class="va">n_genes_in_class</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">n_class</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
    end <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">n_genes_in_class</span><span class="op">)</span>,
    start <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/lead-lag.html">lag</a></span><span class="op">(</span><span class="va">end</span>, default <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,
    textpos <span class="op">=</span> <span class="va">start</span> <span class="op">+</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="op">(</span><span class="va">end</span> <span class="op">-</span> <span class="va">start</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">-&gt;</span> <span class="va">annotate.df</span>

<span class="va">dassimKleb_BTKleb.amr</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"Oqx"</span>, <span class="va">gene</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">class</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
    n_class <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">class</span><span class="op">)</span>,
    n_genes_in_class <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/n_distinct.html">n_distinct</a></span><span class="op">(</span><span class="va">gene</span><span class="op">)</span>,
    gene <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"_"</span>, <span class="st">"-"</span>, <span class="va">gene</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_reorder.html">fct_reorder</a></span><span class="op">(</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_rev.html">fct_rev</a></span><span class="op">(</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_inorder.html">fct_infreq</a></span><span class="op">(</span>
    <span class="va">gene</span>
  <span class="op">)</span><span class="op">)</span>, <span class="va">n_class</span><span class="op">)</span>,
  fill <span class="op">=</span> <span class="va">class</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_bar</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">coord_flip</span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="fl">210</span><span class="op">)</span>,
             clip <span class="op">=</span> <span class="st">"off"</span>,
             expand <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">annotate</span><span class="op">(</span>
    geom <span class="op">=</span> <span class="st">"segment"</span>,
    x <span class="op">=</span> <span class="va">annotate.df</span><span class="op">$</span><span class="va">start</span> <span class="op">+</span> <span class="fl">0.5</span> <span class="op">+</span> <span class="fl">0.2</span>,
    xend <span class="op">=</span> <span class="va">annotate.df</span><span class="op">$</span><span class="va">end</span> <span class="op">+</span> <span class="fl">0.5</span> <span class="op">-</span> <span class="fl">0.2</span>,
    y <span class="op">=</span> <span class="op">-</span><span class="fl">60</span>,
    yend <span class="op">=</span> <span class="op">-</span><span class="fl">60</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">annotate</span><span class="op">(</span>
    geom <span class="op">=</span> <span class="st">"text"</span>,
    y <span class="op">=</span> <span class="op">-</span><span class="fl">70</span>,
    x <span class="op">=</span> <span class="va">annotate.df</span><span class="op">$</span><span class="va">textpos</span>,
    label <span class="op">=</span> <span class="va">annotate.df</span><span class="op">$</span><span class="va">class</span>,
    size <span class="op">=</span> <span class="fl">3</span>,
    hjust <span class="op">=</span> <span class="fl">1</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Number"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>
    plot.margin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="fl">0.2</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"cm"</span><span class="op">)</span>,
    axis.title.y  <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,
    legend.position <span class="op">=</span> <span class="st">"none"</span>
  <span class="op">)</span> <span class="op">-&gt;</span> <span class="va">amrplot</span>
<span class="va">amrplot</span></code></pre></div>
<div class="figure">
<img src="analysis-kleb_files/figure-html/amr-1.png" alt="FIGURE X: Prevalence of AMR gene grouped by class" width="576"><p class="caption">
FIGURE X: Prevalence of AMR gene grouped by class
</p>
</div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="kw">if</span> <span class="op">(</span><span class="va">write_figs</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span><span class="op">(</span>
    filename <span class="op">=</span> <span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"figures/kleb-genomics/F2_amr_plot.pdf"</span><span class="op">)</span>,
    plot <span class="op">=</span> <span class="va">amrplot</span>,
    width <span class="op">=</span> <span class="fl">6</span>,
    height <span class="op">=</span> <span class="fl">10</span>
  <span class="op">)</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span><span class="op">(</span>
    filename <span class="op">=</span> <span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"figures/kleb-genomics/F2_amr_plot.svg"</span><span class="op">)</span>,
    plot <span class="op">=</span> <span class="va">amrplot</span>,
    width <span class="op">=</span> <span class="fl">6</span>,
    height <span class="op">=</span> <span class="fl">10</span>
  <span class="op">)</span>
<span class="op">}</span></code></pre></div>
</div>
<div id="clustering-of-amr-genes" class="section level2">
<h2 class="hasAnchor">
<a href="#clustering-of-amr-genes" class="anchor"></a>Clustering of AMR genes</h2>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># jaccard distance</span>

<span class="va">dassimKleb_BTKleb.amr</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"AmpH|Oqx|ParC|GyrA"</span>, <span class="va">gene</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">class</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span>id_cols <span class="op">=</span> <span class="va">lane</span> ,
              names_from <span class="op">=</span> <span class="va">gene</span>, 
              values_from <span class="op">=</span> <span class="va">gene</span>,
              values_fn <span class="op">=</span> <span class="va">length</span>,
              values_fill <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">amr.ariba.onehot</span>


<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">amr.ariba.onehot</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"_"</span>,<span class="st">"-"</span>,<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">amr.ariba.onehot</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span>
  <span class="fl">1</span><span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">amr.ariba.onehot</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"binary"</span><span class="op">)</span>
  <span class="op">)</span>
<span class="op">)</span> <span class="op">-&gt;</span> <span class="va">clust.amr</span>

<span class="fu">ggplotify</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggplotify/man/as.ggplot.html">as.ggplot</a></span><span class="op">(</span>
<span class="fu"><a href="https://rdrr.io/pkg/pheatmap/man/pheatmap.html">pheatmap</a></span><span class="op">(</span><span class="va">clust.amr</span>, 
         color <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/viridis_pal.html">viridis_pal</a></span><span class="op">(</span><span class="op">)</span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>,
         fontsize <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>
<span class="op">)</span> <span class="op">-&gt;</span> <span class="va">amr.heatmap</span></code></pre></div>
<div class="figure">
<img src="analysis-kleb_files/figure-html/cluster-amr-1.png" alt="SUPPLEMENTARY FIGURE X: Jaccard-distance heatmap of presence of ARIBA-identified AMR genes, clustered with a hierarchical clustering algorithm. Several AMR-gene clusters are apparent. Excluded from this matrix are the chromasomally-integrated gyrA, parC (quinolone resistance genes) and the ampH penicillinase." width="672"><p class="caption">
SUPPLEMENTARY FIGURE X: Jaccard-distance heatmap of presence of ARIBA-identified AMR genes, clustered with a hierarchical clustering algorithm. Several AMR-gene clusters are apparent. Excluded from this matrix are the chromasomally-integrated gyrA, parC (quinolone resistance genes) and the ampH penicillinase.
</p>
</div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="kw">if</span> <span class="op">(</span><span class="va">write_figs</span><span class="op">)</span> <span class="op">{</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span><span class="op">(</span>filename <span class="op">=</span> <span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"figures/kleb-genomics/SUP_F_amr_heatmap.svg"</span><span class="op">)</span>,
       plot <span class="op">=</span> <span class="va">amr.heatmap</span>,
       width <span class="op">=</span><span class="fl">9</span>,
       height <span class="op">=</span> <span class="fl">8</span>
<span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span><span class="op">(</span>filename <span class="op">=</span> <span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"figures/kleb-genomics/SUP_F_amr_heatmap.pdf"</span><span class="op">)</span>,
       plot <span class="op">=</span> <span class="va">amr.heatmap</span>,
       width <span class="op">=</span><span class="fl">9</span>,
       height <span class="op">=</span> <span class="fl">8</span>
<span class="op">)</span>
<span class="op">}</span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R">


<span class="va">dassimKleb_BTKleb.amr</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">gene</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"OqxA"</span>, <span class="st">"OqxB"</span>, <span class="st">"FosA"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># remove FosA as not in KpI which we are plottingh</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>lane <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"#"</span>, <span class="st">"_"</span>, <span class="va">lane</span><span class="op">)</span>,
         gene <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"_"</span>,<span class="st">"-"</span>, <span class="va">gene</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">class</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>n_class <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">class</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">gene</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>n_gene <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">gene</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">n_class</span><span class="op">)</span>, <span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">n_gene</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">n_class</span>, <span class="op">-</span><span class="va">n_gene</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span>id_cols <span class="op">=</span> <span class="va">lane</span>,
              values_from <span class="op">=</span> <span class="va">class</span>,
              names_from <span class="op">=</span> <span class="va">gene</span><span class="op">)</span> <span class="op">%&gt;%</span> 

  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-&gt;</span>
  <span class="va">amr.ariba.maptotree</span>

<span class="va">dassimKleb_BTKleb.amr</span> <span class="op">%&gt;%</span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">gene</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"OqxA"</span>, <span class="st">"OqxB"</span>, <span class="st">"FosA"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>lane <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"#"</span>, <span class="st">"_"</span>, <span class="va">lane</span><span class="op">)</span>,
           gene <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"_"</span>,<span class="st">"-"</span>, <span class="va">gene</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">class</span><span class="op">)</span> <span class="op">%&gt;%</span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>n_class <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">class</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">gene</span><span class="op">)</span> <span class="op">%&gt;%</span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>n_gene <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">gene</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">n_class</span><span class="op">)</span>, <span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">n_gene</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">class</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">class_order</span>

<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">amr.ariba.maptotree</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">amr.ariba.maptotree</span><span class="op">$</span><span class="va">lane</span>

<span class="va">colz</span> <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/hue_pal.html">hue_pal</a></span><span class="op">(</span><span class="op">)</span><span class="op">(</span><span class="fl">11</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">colz</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">dassimKleb_BTKleb.amr</span> <span class="op">%&gt;%</span> 
                        <span class="co">#     filter(class != "Fosfomycin") %&gt;% </span>
                             <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">class</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/ggtree.html">ggtree</a></span><span class="op">(</span><span class="fu">treeio</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/treeio/reference/tree_subset.html">tree_subset</a></span><span class="op">(</span><span class="va">dassimKleb_trees.BTcarriage</span>, <span class="fl">210</span>, levels_back <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
<span class="co">#ggtree(tree) %&gt;% </span>
    <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/gheatmap.html">gheatmap</a></span><span class="op">(</span>
        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">amr.ariba.maptotree</span>,<span class="op">-</span><span class="va">lane</span><span class="op">)</span>,
        width <span class="op">=</span> <span class="fl">5</span>, 
        color <span class="op">=</span> <span class="cn">NA</span>, 
        font.size <span class="op">=</span> <span class="fl">3</span>, 
        colnames_angle <span class="op">=</span> <span class="fl">90</span>, 
        colnames_position <span class="op">=</span> <span class="st">"top"</span>, 
        colnames_offset_y <span class="op">=</span> <span class="fl">0</span>,
        hjust <span class="op">=</span> <span class="fl">0</span>,
        offset <span class="op">=</span> <span class="fl">0</span>
    <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">ylim</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">210</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Class"</span>, values <span class="op">=</span> <span class="va">colz</span>, 
                    breaks <span class="op">=</span> <span class="va">class_order</span>,
                    na.translate <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">-&gt;</span>
  <span class="va">malawi_tree_with_amr_kp1</span>
<span class="co">#&gt; Scale for 'y' is already present. Adding another scale for 'y', which will</span>
<span class="co">#&gt; replace the existing scale.</span>
<span class="co">#&gt; Scale for 'fill' is already present. Adding another scale for 'fill', which</span>
<span class="co">#&gt; will replace the existing scale.</span>


<span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/ggtree.html">ggtree</a></span><span class="op">(</span><span class="va">dassimKleb_trees.BTcarriage</span><span class="op">)</span> <span class="op">%&gt;%</span> 
<span class="co">#ggtree(tree) %&gt;% </span>
    <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/gheatmap.html">gheatmap</a></span><span class="op">(</span>
        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">amr.ariba.maptotree</span>,<span class="op">-</span><span class="va">lane</span><span class="op">)</span>,
        width <span class="op">=</span> <span class="fl">5</span>, 
        color <span class="op">=</span> <span class="cn">NA</span>, 
        font.size <span class="op">=</span> <span class="fl">3</span>, 
        colnames_angle <span class="op">=</span> <span class="fl">90</span>, 
        colnames_position <span class="op">=</span> <span class="st">"top"</span>, 
        colnames_offset_y <span class="op">=</span> <span class="fl">0</span>,
        hjust <span class="op">=</span> <span class="fl">0</span>,
        offset <span class="op">=</span> <span class="fl">0</span>
    <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">ylim</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">220</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Class"</span>, values <span class="op">=</span> <span class="va">colz</span>, 
                    breaks <span class="op">=</span> <span class="va">class_order</span>,
                    na.translate <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">-&gt;</span>
  <span class="va">malawi_tree_with_amr_all</span>
<span class="co">#&gt; Scale for 'y' is already present. Adding another scale for 'y', which will</span>
<span class="co">#&gt; replace the existing scale.</span>
<span class="co">#&gt; Scale for 'fill' is already present. Adding another scale for 'fill', which</span>
<span class="co">#&gt; will replace the existing scale.</span>

<span class="op">(</span><span class="va">malawi_tree_with_amr_kp1</span> <span class="op">/</span> <span class="va">malawi_tree_with_amr_all</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_annotation.html">plot_annotation</a></span><span class="op">(</span>tag_levels <span class="op">=</span> <span class="st">"A"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html">plot_layout</a></span><span class="op">(</span>guides <span class="op">=</span> <span class="st">"collect"</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">tree_amr_plt</span>

<span class="va">tree_amr_plt</span></code></pre></div>
<div class="figure">
<img src="analysis-kleb_files/figure-html/malawi-tree-with-amr-1.png" alt="Presence of ARIBA-identified AMR genes mapped back to phylogeny for (A) KPI isolates only (B) all samples. Some lineage association of AMR genes is apparent." width="1248"><p class="caption">
Presence of ARIBA-identified AMR genes mapped back to phylogeny for (A) KPI isolates only (B) all samples. Some lineage association of AMR genes is apparent.
</p>
</div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="kw">if</span> <span class="op">(</span><span class="va">write_figs</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span><span class="op">(</span>
    filename <span class="op">=</span> <span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"figures/kleb-genomics/SUP_F_amr_tree.pdf"</span><span class="op">)</span>,
    plot <span class="op">=</span> <span class="va">tree_amr_plt</span>,
    width <span class="op">=</span> <span class="fl">14</span>,
    height <span class="op">=</span> <span class="fl">12</span>
  <span class="op">)</span>
  
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span><span class="op">(</span>
    filename <span class="op">=</span> <span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"figures/kleb-genomics/SUP_F_amr_tree.svg"</span><span class="op">)</span>,
    plot <span class="op">=</span> <span class="va">tree_amr_plt</span>,
    width <span class="op">=</span> <span class="fl">14</span>,
    height <span class="op">=</span> <span class="fl">12</span>
  <span class="op">)</span>
<span class="op">}</span></code></pre></div>
</div>
<div id="diversity-of-malawian-carriage-isolates-in-a-global-context" class="section level2">
<h2 class="hasAnchor">
<a href="#diversity-of-malawian-carriage-isolates-in-a-global-context" class="anchor"></a>Diversity of Malawian carriage isolates in a global context</h2>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">dassimKleb_trees.global</span> <span class="op">&lt;-</span> <span class="va">btESBL_kleb_globaltree</span>
<span class="va">btESBL_kleb_global_metadata</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>`Isolate Type` <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span>
    <span class="va">`Isolate Type`</span> <span class="op">==</span> <span class="st">"Carriage"</span> <span class="op">~</span> <span class="st">"Colonising"</span>,
    <span class="va">`Isolate Type`</span> <span class="op">==</span> <span class="st">"Infection"</span> <span class="op">~</span> <span class="st">"Invasive"</span>,
    <span class="cn">TRUE</span> <span class="op">~</span> <span class="va">`Isolate Type`</span><span class="op">)</span><span class="op">)</span> <span class="op">-&gt;</span>
<span class="va">dassimKleb_globalKleb.metadata</span> 

<span class="va">col</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"white"</span>,
    <span class="st">"grey30"</span>,
    <span class="fu"><a href="https://scales.r-lib.org/reference/brewer_pal.html">brewer_pal</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set3"</span><span class="op">)</span><span class="op">(</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">col</span><span class="op">)</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"0"</span>,
    <span class="st">"1"</span>,
    <span class="st">"Human"</span>,
    <span class="st">"Animal"</span>,
    <span class="st">"Environmental"</span>,
    <span class="st">"Invasive"</span>,
    <span class="st">"Colonising"</span>,
    <span class="st">"ESBL"</span><span class="op">)</span> 

<span class="fu"><a href="https://wilkelab.org/cowplot/reference/get_legend.html">get_legend</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/ggtree.html">ggtree</a></span><span class="op">(</span><span class="va">dassimKleb_trees.global</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/gheatmap.html">gheatmap</a></span><span class="op">(</span>
      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">dassimKleb_globalKleb.metadata</span>, <span class="va">`Sample Source`</span><span class="op">)</span>,
      width <span class="op">=</span> <span class="fl">0.05</span>,
      color <span class="op">=</span> <span class="cn">NA</span>,
      font.size <span class="op">=</span> <span class="fl">4</span>,
      colnames_angle <span class="op">=</span> <span class="fl">90</span>,
      colnames_position <span class="op">=</span> <span class="st">"top"</span>,
      colnames_offset_y <span class="op">=</span> <span class="fl">5</span>,
      hjust <span class="op">=</span> <span class="fl">0</span>,
      offset <span class="op">=</span> <span class="fl">0.0015</span>
    <span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">col</span><span class="op">[</span><span class="op">(</span><span class="fl">3</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span><span class="op">]</span>, na.translate <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span> <span class="op">-&gt;</span> <span class="va">leg1</span>
<span class="co">#&gt; Scale for 'fill' is already present. Adding another scale for 'fill', which</span>
<span class="co">#&gt; will replace the existing scale.</span>

<span class="fu"><a href="https://wilkelab.org/cowplot/reference/get_legend.html">get_legend</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/ggtree.html">ggtree</a></span><span class="op">(</span><span class="va">dassimKleb_trees.global</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/gheatmap.html">gheatmap</a></span><span class="op">(</span>
      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">dassimKleb_globalKleb.metadata</span>, <span class="va">`Isolate Type`</span><span class="op">)</span>,
      width <span class="op">=</span> <span class="fl">0.05</span>,
      color <span class="op">=</span> <span class="cn">NA</span>,
      font.size <span class="op">=</span> <span class="fl">4</span>,
      colnames_angle <span class="op">=</span> <span class="fl">90</span>,
      colnames_position <span class="op">=</span> <span class="st">"top"</span>,
      colnames_offset_y <span class="op">=</span> <span class="fl">5</span>,
      hjust <span class="op">=</span> <span class="fl">0</span>,
      offset <span class="op">=</span> <span class="fl">0.0015</span>
    <span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">col</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>,<span class="fl">7</span><span class="op">)</span><span class="op">]</span>, na.translate <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span> <span class="op">-&gt;</span> <span class="va">leg2</span>
<span class="co">#&gt; Scale for 'fill' is already present. Adding another scale for 'fill', which</span>
<span class="co">#&gt; will replace the existing scale.</span>
  
<span class="fu"><a href="https://wilkelab.org/cowplot/reference/get_legend.html">get_legend</a></span><span class="op">(</span>
<span class="va">dassimKleb_globalKleb.metadata</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>ESBL <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else</a></span><span class="op">(</span><span class="va">ESBL</span> <span class="op">!=</span> <span class="st">"ESBL"</span>, <span class="cn">NA_character_</span>, <span class="va">ESBL</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">ESBL</span>, fill <span class="op">=</span> <span class="va">ESBL</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_bar</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">col</span><span class="op">[</span><span class="fl">8</span><span class="op">]</span>, na.translate <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">-&gt;</span> <span class="va">leg3</span>

<span class="fu"><a href="https://wilkelab.org/cowplot/reference/get_legend.html">get_legend</a></span><span class="op">(</span>
<span class="va">dassimKleb_globalKleb.metadata</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>ybt <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else</a></span><span class="op">(</span><span class="va">ybt</span> <span class="op">==</span> <span class="st">"0"</span>, <span class="cn">NA_character_</span>, <span class="st">"Gene\nPresent"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">ybt</span>, fill <span class="op">=</span> <span class="va">ybt</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_bar</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="st">"grey30"</span>, na.translate <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">-&gt;</span> <span class="va">leg4</span>

<span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/ggtree.html">ggtree</a></span><span class="op">(</span><span class="fu">treeio</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/treeio/reference/tree_subset.html">tree_subset</a></span><span class="op">(</span><span class="va">dassimKleb_trees.global</span>, <span class="fl">734</span>, levels_back <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/gheatmap.html">gheatmap</a></span><span class="op">(</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">dassimKleb_globalKleb.metadata</span>, <span class="va">Malawi</span><span class="op">)</span>,
    width <span class="op">=</span> <span class="fl">0.03</span>,
    color <span class="op">=</span> <span class="cn">NA</span>,
    font.size <span class="op">=</span> <span class="fl">4</span>,
    colnames_angle <span class="op">=</span> <span class="fl">90</span>,
    colnames_position <span class="op">=</span> <span class="st">"top"</span>,
    colnames_offset_y <span class="op">=</span> <span class="fl">5</span>,
    hjust <span class="op">=</span> <span class="fl">0</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/gheatmap.html">gheatmap</a></span><span class="op">(</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">dassimKleb_globalKleb.metadata</span>, <span class="va">`Sample Source`</span><span class="op">)</span>,
    width <span class="op">=</span> <span class="fl">0.03</span>,
    color <span class="op">=</span> <span class="cn">NA</span>,
    font.size <span class="op">=</span> <span class="fl">4</span>,
    colnames_angle <span class="op">=</span> <span class="fl">90</span>,
    colnames_position <span class="op">=</span> <span class="st">"top"</span>,
    colnames_offset_y <span class="op">=</span> <span class="fl">5</span>,
    hjust <span class="op">=</span> <span class="fl">0</span>,
    offset <span class="op">=</span> <span class="fl">0.0007</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/gheatmap.html">gheatmap</a></span><span class="op">(</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">dassimKleb_globalKleb.metadata</span>, <span class="va">`Isolate Type`</span><span class="op">)</span>,
    width <span class="op">=</span> <span class="fl">0.03</span>,
    color <span class="op">=</span> <span class="cn">NA</span>,
    font.size <span class="op">=</span> <span class="fl">4</span>,
    colnames_angle <span class="op">=</span> <span class="fl">90</span>,
    colnames_position <span class="op">=</span> <span class="st">"top"</span>,
    colnames_offset_y <span class="op">=</span> <span class="fl">5</span>,
    hjust <span class="op">=</span> <span class="fl">0</span>,
    offset <span class="op">=</span> <span class="fl">0.0014</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>   <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/gheatmap.html">gheatmap</a></span><span class="op">(</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">dassimKleb_globalKleb.metadata</span>, <span class="va">ESBL</span><span class="op">)</span>,
    width <span class="op">=</span> <span class="fl">0.03</span>,
    color <span class="op">=</span> <span class="cn">NA</span>,
    font.size <span class="op">=</span> <span class="fl">4</span>,
    colnames_angle <span class="op">=</span> <span class="fl">90</span>,
    colnames_position <span class="op">=</span> <span class="st">"top"</span>,
    colnames_offset_y <span class="op">=</span> <span class="fl">5</span>,
    hjust <span class="op">=</span> <span class="fl">0</span>,
    offset <span class="op">=</span> <span class="fl">0.0021</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">ylim</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">680</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">col</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/geom_cladelabel.html">geom_cladelabel</a></span><span class="op">(</span>
    node <span class="op">=</span> <span class="fl">784</span>,
    label <span class="op">=</span> <span class="st">"ST14"</span>,
    align <span class="op">=</span> <span class="cn">TRUE</span>,
    offset <span class="op">=</span> <span class="op">-</span><span class="fl">0.002</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/geom_cladelabel.html">geom_cladelabel</a></span><span class="op">(</span>
    node <span class="op">=</span> <span class="fl">827</span>,
    label <span class="op">=</span> <span class="st">"ST15"</span>,
    align <span class="op">=</span> <span class="cn">TRUE</span>,
    offset <span class="op">=</span> <span class="op">-</span><span class="fl">0.002</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/geom_cladelabel.html">geom_cladelabel</a></span><span class="op">(</span>
    node <span class="op">=</span> <span class="fl">1020</span>,
    label <span class="op">=</span> <span class="st">"ST340"</span>,
    align <span class="op">=</span> <span class="cn">TRUE</span>,
    offset <span class="op">=</span> <span class="op">-</span><span class="fl">0.002</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/geom_cladelabel.html">geom_cladelabel</a></span><span class="op">(</span>
    node <span class="op">=</span> <span class="fl">1066</span>,
    label <span class="op">=</span> <span class="st">"ST307"</span>,
    align <span class="op">=</span> <span class="cn">TRUE</span>,
    offset <span class="op">=</span> <span class="op">-</span><span class="fl">0.002</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/geom_treescale.html">geom_treescale</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0.001</span>, y <span class="op">=</span> <span class="fl">550</span>, offset <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">-&gt;</span>
  <span class="va">treeplot</span>
<span class="co">#&gt; Scale for 'fill' is already present. Adding another scale for 'fill', which</span>
<span class="co">#&gt; will replace the existing scale.</span>
<span class="co">#&gt; Scale for 'fill' is already present. Adding another scale for 'fill', which</span>
<span class="co">#&gt; will replace the existing scale.</span>
<span class="co">#&gt; Scale for 'fill' is already present. Adding another scale for 'fill', which</span>
<span class="co">#&gt; will replace the existing scale.</span>
<span class="co">#&gt; Scale for 'y' is already present. Adding another scale for 'y', which will</span>
<span class="co">#&gt; replace the existing scale.</span>
<span class="co">#&gt; Scale for 'fill' is already present. Adding another scale for 'fill', which</span>
<span class="co">#&gt; will replace the existing scale.</span>
  
<span class="va">treeplot</span> <span class="op">+</span>
  <span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html">ggarrange</a></span><span class="op">(</span><span class="cn">NULL</span>,<span class="va">leg1</span>, <span class="va">leg2</span>, <span class="va">leg3</span>, <span class="cn">NULL</span>, ncol <span class="op">=</span> <span class="fl">1</span>, heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0.3</span>,<span class="fl">0.3</span>,<span class="fl">0.3</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html">plot_layout</a></span><span class="op">(</span>widths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">globaltree_plot</span>

<span class="va">globaltree_plot</span>  </code></pre></div>
<p><img src="analysis-kleb_files/figure-html/global-tree-1.png" width="768"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="kw">if</span> <span class="op">(</span><span class="va">write_figs</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span><span class="op">(</span>
    filename <span class="op">=</span> <span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"figures/kleb-genomics/F3_globaltree.pdf"</span><span class="op">)</span>,
    plot <span class="op">=</span> <span class="va">globaltree_plot</span>,
    width <span class="op">=</span> <span class="fl">8</span>,
    height <span class="op">=</span> <span class="fl">12</span>
  <span class="op">)</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span><span class="op">(</span>
    filename <span class="op">=</span> <span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"figures/kleb-genomics/F3_globaltree.svg"</span><span class="op">)</span>,
    plot <span class="op">=</span> <span class="va">globaltree_plot</span>,
    width <span class="op">=</span> <span class="fl">8</span>,
    height <span class="op">=</span> <span class="fl">12</span>
  <span class="op">)</span>
<span class="op">}</span></code></pre></div>
</div>
<div id="malawian-isolates-comparing-carriage-and-infection" class="section level2">
<h2 class="hasAnchor">
<a href="#malawian-isolates-comparing-carriage-and-infection" class="anchor"></a>Malawian isolates: comparing carriage and infection</h2>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R">



<span class="co"># 627  = ST 218</span>

<span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/ggtree.html">ggtree</a></span><span class="op">(</span><span class="fu">treeio</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/treeio/reference/tree_subset.html">tree_subset</a></span><span class="op">(</span><span class="va">btESBL_kleb_malawi_allisolate_core_gene_tree</span>, <span class="fl">372</span>, levels_back <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/gheatmap.html">gheatmap</a></span><span class="op">(</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">dassimKleb_globalKleb.metadata</span>, <span class="va">`Isolate Type`</span><span class="op">)</span>,
    width <span class="op">=</span> <span class="fl">0.03</span>,
    color <span class="op">=</span> <span class="cn">NA</span>,
    font.size <span class="op">=</span> <span class="fl">4</span>,
    colnames_angle <span class="op">=</span> <span class="fl">90</span>,
    colnames_position <span class="op">=</span> <span class="st">"top"</span>,
    colnames_offset_y <span class="op">=</span> <span class="fl">5</span>,
    hjust <span class="op">=</span> <span class="fl">0</span>,
    offset <span class="op">=</span> <span class="fl">0.001</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>   <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/gheatmap.html">gheatmap</a></span><span class="op">(</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">dassimKleb_globalKleb.metadata</span>, <span class="va">ESBL</span><span class="op">)</span>,
    width <span class="op">=</span> <span class="fl">0.03</span>,
    color <span class="op">=</span> <span class="cn">NA</span>,
    font.size <span class="op">=</span> <span class="fl">4</span>,
    colnames_angle <span class="op">=</span> <span class="fl">90</span>,
    colnames_position <span class="op">=</span> <span class="st">"top"</span>,
    colnames_offset_y <span class="op">=</span> <span class="fl">5</span>,
    hjust <span class="op">=</span> <span class="fl">0</span>,
    offset <span class="op">=</span> <span class="fl">0</span>
  <span class="op">)</span><span class="op">%&gt;%</span>   <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/gheatmap.html">gheatmap</a></span><span class="op">(</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">dassimKleb_globalKleb.metadata</span>, <span class="va">ybt</span>,<span class="va">clb</span>,<span class="va">iuc</span>,<span class="va">iro</span>,<span class="va">rmpA</span>,<span class="va">rmpA2</span><span class="op">)</span>,
    width <span class="op">=</span> <span class="fl">0.18</span>,
    color <span class="op">=</span> <span class="st">"black"</span>,
    font.size <span class="op">=</span> <span class="fl">4</span>,
    colnames_angle <span class="op">=</span> <span class="fl">90</span>,
    colnames_position <span class="op">=</span> <span class="st">"top"</span>,
    colnames_offset_y <span class="op">=</span> <span class="fl">5</span>,
    hjust <span class="op">=</span> <span class="fl">0</span>,
    offset <span class="op">=</span> <span class="fl">0.002</span>
  <span class="op">)</span>  <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">col</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">ylim</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">370</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/geom_cladelabel.html">geom_cladelabel</a></span><span class="op">(</span>node <span class="op">=</span> <span class="fl">599</span>, label <span class="op">=</span> <span class="st">"ST268"</span>, align <span class="op">=</span> <span class="cn">TRUE</span>, offset <span class="op">=</span> <span class="op">-</span> <span class="fl">0.003</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/geom_cladelabel.html">geom_cladelabel</a></span><span class="op">(</span>node <span class="op">=</span> <span class="fl">582</span>, label <span class="op">=</span> <span class="st">"ST218"</span>, align <span class="op">=</span> <span class="cn">TRUE</span>, offset <span class="op">=</span> <span class="op">-</span> <span class="fl">0.003</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/geom_cladelabel.html">geom_cladelabel</a></span><span class="op">(</span>node <span class="op">=</span> <span class="fl">377</span>, label <span class="op">=</span> <span class="st">"ST14"</span>, align <span class="op">=</span> <span class="cn">TRUE</span>, offset <span class="op">=</span> <span class="op">-</span> <span class="fl">0.003</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/geom_cladelabel.html">geom_cladelabel</a></span><span class="op">(</span>node <span class="op">=</span> <span class="fl">413</span>, label <span class="op">=</span> <span class="st">"ST15"</span>, align <span class="op">=</span> <span class="cn">TRUE</span>, offset <span class="op">=</span> <span class="op">-</span> <span class="fl">0.003</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/geom_cladelabel.html">geom_cladelabel</a></span><span class="op">(</span>node <span class="op">=</span> <span class="fl">531</span>, label <span class="op">=</span> <span class="st">"ST340"</span>, align <span class="op">=</span> <span class="cn">TRUE</span>, offset <span class="op">=</span> <span class="op">-</span> <span class="fl">0.003</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/geom_cladelabel.html">geom_cladelabel</a></span><span class="op">(</span>node <span class="op">=</span> <span class="fl">607</span>, label <span class="op">=</span> <span class="st">"ST307"</span>, align <span class="op">=</span> <span class="cn">TRUE</span>, offset <span class="op">=</span> <span class="op">-</span> <span class="fl">0.003</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/geom_treescale.html">geom_treescale</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/geom_treescale.html">geom_treescale</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0.001</span>, y <span class="op">=</span> <span class="fl">280</span>, offset <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">malawi_tree_plot</span>
<span class="co">#&gt; Scale for 'fill' is already present. Adding another scale for 'fill', which</span>
<span class="co">#&gt; will replace the existing scale.</span>
<span class="co">#&gt; Scale for 'fill' is already present. Adding another scale for 'fill', which</span>
<span class="co">#&gt; will replace the existing scale.</span>
<span class="co">#&gt; Scale for 'fill' is already present. Adding another scale for 'fill', which</span>
<span class="co">#&gt; will replace the existing scale.</span>
<span class="co">#&gt; Scale for 'y' is already present. Adding another scale for 'y', which will</span>
<span class="co">#&gt; replace the existing scale.</span>

<span class="va">malawi_tree_plot</span> <span class="op">+</span>
  <span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html">ggarrange</a></span><span class="op">(</span><span class="cn">NULL</span>,<span class="va">leg3</span>,<span class="va">leg2</span>,<span class="va">leg4</span>, <span class="cn">NULL</span>, ncol <span class="op">=</span> <span class="fl">1</span>, heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0.2</span>,<span class="fl">0.4</span>,<span class="fl">0.2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html">plot_layout</a></span><span class="op">(</span>widths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">malawi_tree_plot_final</span>

<span class="va">malawi_tree_plot_final</span></code></pre></div>
<div class="figure">
<img src="analysis-kleb_files/figure-html/malawitree-1.png" alt="Midpoint rooted core gene maximum likelihood phylogenetic tree of Malawian isolates." width="768"><p class="caption">
Midpoint rooted core gene maximum likelihood phylogenetic tree of Malawian isolates.
</p>
</div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="kw">if</span> <span class="op">(</span><span class="va">write_figs</span><span class="op">)</span> <span class="op">{</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span><span class="op">(</span>filename <span class="op">=</span> <span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"figures/kleb-genomics/F4_malawitree.pdf"</span><span class="op">)</span>,
       plot <span class="op">=</span> <span class="va">malawi_tree_plot_final</span>,
       width <span class="op">=</span><span class="fl">8</span>,
       height <span class="op">=</span> <span class="fl">10</span>
<span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span><span class="op">(</span>filename <span class="op">=</span> <span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"figures/kleb-genomics/F4_malawitree.svg"</span><span class="op">)</span>,
       plot <span class="op">=</span> <span class="va">malawi_tree_plot_final</span>,
       width <span class="op">=</span><span class="fl">8</span>,
       height <span class="op">=</span> <span class="fl">10</span>
<span class="op">)</span>
<span class="op">}</span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">dassimKleb_globalKleb.metadata</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">location</span> <span class="op">==</span> <span class="st">"Malawi"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>ESBL <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else</a></span><span class="op">(</span><span class="va">ESBL</span><span class="op">==</span> <span class="st">"ESBL"</span>,<span class="st">"ESBL"</span>,<span class="st">"Not ESBL"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">`Isolate Type`</span>, <span class="va">ESBL</span>, <span class="va">ybt</span>,<span class="va">clb</span>,<span class="va">iuc</span>,<span class="va">iro</span>,<span class="va">rmpA</span>, <span class="va">rmpA2</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">`Isolate Type`</span>, <span class="va">ESBL</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>value <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else</a></span><span class="op">(</span><span class="va">value</span> <span class="op">==</span> <span class="fl">1</span>, <span class="st">"Present"</span>, <span class="st">"Absent"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>  
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">name</span>, fill <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_bar</span><span class="op">(</span>position <span class="op">=</span> <span class="st">"fill"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_grid</span><span class="op">(</span><span class="op">~</span><span class="va">`Isolate Type`</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_fill_viridis_d</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span><span class="fl">1</span><span class="op">)</span>,
        legend.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Proportion"</span>, x <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">-&gt;</span> <span class="va">a</span>

<span class="va">dassimKleb_globalKleb.metadata</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">location</span> <span class="op">==</span> <span class="st">"Malawi"</span>,
         <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">ESBL</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>ESBL <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else</a></span><span class="op">(</span><span class="va">ESBL</span><span class="op">==</span> <span class="st">"ESBL"</span>,<span class="st">"ESBL"</span>,<span class="st">"Not ESBL"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">`Isolate Type`</span>, <span class="va">ESBL</span>, <span class="va">ybt</span>,<span class="va">clb</span>,<span class="va">iuc</span>,<span class="va">iro</span>,<span class="va">rmpA</span>, <span class="va">rmpA2</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">`Isolate Type`</span>, <span class="va">ESBL</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>value <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else</a></span><span class="op">(</span><span class="va">value</span> <span class="op">==</span> <span class="fl">1</span>, <span class="st">"Present"</span>, <span class="st">"Absent"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">name</span>, fill <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_bar</span><span class="op">(</span>position <span class="op">=</span> <span class="st">"fill"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_grid</span><span class="op">(</span><span class="op">~</span><span class="va">ESBL</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_fill_viridis_d</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span><span class="fl">1</span><span class="op">)</span>,
        legend.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Proportion"</span>, x <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">b</span>

<span class="op">(</span><span class="va">a</span> <span class="op">/</span> <span class="va">b</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html">plot_layout</a></span><span class="op">(</span>guides <span class="op">=</span> <span class="st">"collect"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_annotation.html">plot_annotation</a></span><span class="op">(</span>tag_levels <span class="op">=</span> <span class="st">"A"</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">virplot</span>
<span class="va">virplot</span></code></pre></div>
<p><img src="analysis-kleb_files/figure-html/inv_vs_carriage-1.png" width="480"></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R">

<span class="kw">if</span> <span class="op">(</span><span class="va">write_figs</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span><span class="op">(</span>
    filename <span class="op">=</span> <span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"figures/kleb-genomics/SUPP_FIG_virplot.pdf"</span><span class="op">)</span>,
    plot <span class="op">=</span> <span class="va">virplot</span>,
    width <span class="op">=</span> <span class="fl">5</span>,
    height <span class="op">=</span> <span class="fl">5</span>
  <span class="op">)</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span><span class="op">(</span>
    filename <span class="op">=</span> <span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"figures/kleb-genomics/SUPP_FIG_virplot.svg"</span><span class="op">)</span>,
    plot <span class="op">=</span> <span class="va">virplot</span>,
    width <span class="op">=</span> <span class="fl">5</span>,
    height <span class="op">=</span> <span class="fl">5</span>
  <span class="op">)</span>
<span class="op">}</span></code></pre></div>
</div>
<div id="o-types-infection-vs-carriage" class="section level2">
<h2 class="hasAnchor">
<a href="#o-types-infection-vs-carriage" class="anchor"></a>O types infection vs carriage</h2>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">dassimKleb_globalKleb.metadata</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">study</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"cornick"</span>, <span class="st">"DASSIM"</span>,<span class="st">"musciha"</span><span class="op">)</span>,
         <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">O_locus</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>O_locus <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span>
    <span class="va">O_locus_confidence</span> <span class="op">%in%</span> 
           <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Good"</span>,
             <span class="st">"High"</span>,             
             <span class="st">"Very high"</span><span class="op">)</span> <span class="op">~</span> <span class="va">O_locus</span>,
    <span class="cn">TRUE</span> <span class="op">~</span> <span class="st">"Unknown"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>K_locus <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span>
    <span class="va">K_locus_confidence</span> <span class="op">%in%</span> 
           <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Good"</span>,
             <span class="st">"High"</span>,             
             <span class="st">"Very high"</span><span class="op">)</span> <span class="op">~</span> <span class="va">K_locus</span>,
    <span class="cn">TRUE</span> <span class="op">~</span> <span class="st">"Unknown"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">`Isolate Type`</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>total <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">O_locus</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">O_locus</span>, <span class="va">`Isolate Type`</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>prop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">O_locus</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">total</span><span class="op">)</span>,
            lci <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/binom.test.html">binom.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">O_locus</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">total</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">conf.int</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,
            uci <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/binom.test.html">binom.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">O_locus</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">total</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">conf.int</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_rev.html">fct_rev</a></span><span class="op">(</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_reorder.html">fct_reorder</a></span><span class="op">(</span><span class="va">O_locus</span>,<span class="va">prop</span><span class="op">)</span><span class="op">)</span>, 
             <span class="va">prop</span>, 
             color <span class="op">=</span> <span class="va">`Isolate Type`</span>,
             shape <span class="op">=</span> <span class="va">`Isolate Type`</span>,
             ymin <span class="op">=</span> <span class="va">lci</span>,
             ymax <span class="op">=</span> <span class="va">uci</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>position <span class="op">=</span> <span class="fu">position_dodge</span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_errorbar</span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0</span>, position <span class="op">=</span> <span class="fu">position_dodge</span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust<span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"O-type"</span>, y <span class="op">=</span> <span class="st">"Proportion of samples"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/hue_pal.html">hue_pal</a></span><span class="op">(</span><span class="op">)</span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> <span class="op">-&gt;</span>
  <span class="va">o_type_distn_plot</span>
<span class="co">#&gt; `summarise()` has grouped output by 'O_locus'. You can override using the `.groups` argument.</span>



<span class="va">dassimKleb_globalKleb.metadata</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">study</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"cornick"</span>, <span class="st">"DASSIM"</span>,<span class="st">"musciha"</span><span class="op">)</span>,
         <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">O_locus</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>O_locus <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span>
    <span class="va">O_locus_confidence</span> <span class="op">%in%</span> 
           <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Good"</span>,
             <span class="st">"High"</span>,             
             <span class="st">"Very high"</span><span class="op">)</span> <span class="op">~</span> <span class="va">O_locus</span>,
    <span class="cn">TRUE</span> <span class="op">~</span> <span class="st">"Unknown"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>K_locus <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span>
    <span class="va">K_locus_confidence</span> <span class="op">%in%</span> 
           <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Good"</span>,
             <span class="st">"High"</span>,             
             <span class="st">"Very high"</span><span class="op">)</span> <span class="op">~</span> <span class="va">K_locus</span>,
    <span class="cn">TRUE</span> <span class="op">~</span> <span class="st">"Unknown"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>K_locus <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">K_locus</span><span class="op">)</span>,
         `Isolate Type` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">`Isolate Type`</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">K_locus</span>, <span class="va">`Isolate Type`</span>, .drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">`Isolate Type`</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>total <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">K_locus</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">2</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">K_locus</span>, <span class="va">`Isolate Type`</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>prop <span class="op">=</span> <span class="va">n</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">total</span><span class="op">)</span>,
            lci <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/binom.test.html">binom.test</a></span><span class="op">(</span><span class="va">n</span>, <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">total</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">conf.int</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,
            uci <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/binom.test.html">binom.test</a></span><span class="op">(</span><span class="va">n</span>, <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">total</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">conf.int</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_rev.html">fct_rev</a></span><span class="op">(</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_reorder.html">fct_reorder</a></span><span class="op">(</span><span class="va">K_locus</span>,<span class="va">prop</span><span class="op">)</span><span class="op">)</span>, 
             <span class="va">prop</span>, 
             color <span class="op">=</span> <span class="va">`Isolate Type`</span>,
             shape <span class="op">=</span> <span class="va">`Isolate Type`</span>,
             ymin <span class="op">=</span> <span class="va">lci</span>,
             ymax <span class="op">=</span> <span class="va">uci</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>position <span class="op">=</span> <span class="fu">position_dodge</span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_errorbar</span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0</span>, position <span class="op">=</span> <span class="fu">position_dodge</span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust<span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"K-type"</span>, y <span class="op">=</span> <span class="st">"Proportion of samples"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/hue_pal.html">hue_pal</a></span><span class="op">(</span><span class="op">)</span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> <span class="op">-&gt;</span>
  <span class="va">k_type_distn_plot</span>
<span class="co">#&gt; `summarise()` has grouped output by 'K_locus'. You can override using the `.groups` argument.</span>

<span class="va">o_type_distn_plot</span> <span class="op">+</span> <span class="va">k_type_distn_plot</span> <span class="op">+</span>
  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_annotation.html">plot_annotation</a></span><span class="op">(</span>tag_levels <span class="op">=</span> <span class="st">"A"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html">plot_layout</a></span><span class="op">(</span>widths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1.8</span><span class="op">)</span>, guides <span class="op">=</span> <span class="st">'collect'</span><span class="op">)</span> <span class="op">&amp;</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">o_ktype_distn_plot</span>

<span class="va">o_ktype_distn_plot</span></code></pre></div>
<p><img src="analysis-kleb_files/figure-html/o-type_infn_vs_carriage-1.png" width="960"></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="kw">if</span> <span class="op">(</span><span class="va">write_figs</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span><span class="op">(</span>
    filename <span class="op">=</span> <span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"figures/kleb-genomics/F5_OK_type_distn.svg"</span><span class="op">)</span>,
    plot <span class="op">=</span>  <span class="va">o_ktype_distn_plot</span>,
    width <span class="op">=</span> <span class="fl">10</span>,
    height <span class="op">=</span> <span class="fl">4</span>
  <span class="op">)</span>
  
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span><span class="op">(</span>
    filename <span class="op">=</span> <span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"figures/kleb-genomics/F5_OK_type_distn.pdf"</span><span class="op">)</span>,
    plot <span class="op">=</span>  <span class="va">o_ktype_distn_plot</span>,
    width <span class="op">=</span> <span class="fl">10</span>,
    height <span class="op">=</span> <span class="fl">4</span>
  <span class="op">)</span>
<span class="op">}</span></code></pre></div>
</div>
<div id="testing-independence-of-distributions-of-k--and-o-types" class="section level2">
<h2 class="hasAnchor">
<a href="#testing-independence-of-distributions-of-k--and-o-types" class="anchor"></a>Testing independence of distributions of K- and O-types</h2>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">dassimKleb_globalKleb.metadata</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">study</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"cornick"</span>, <span class="st">"DASSIM"</span>,<span class="st">"musciha"</span><span class="op">)</span>,
         <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">O_locus</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>O_locus <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span>
    <span class="va">O_locus_confidence</span> <span class="op">%in%</span> 
      <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Good"</span>,
        <span class="st">"High"</span>,             
        <span class="st">"Very high"</span><span class="op">)</span> <span class="op">~</span> <span class="va">O_locus</span>,
    <span class="cn">TRUE</span> <span class="op">~</span> <span class="st">"Unknown"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>K_locus <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span>
    <span class="va">K_locus_confidence</span> <span class="op">%in%</span> 
      <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Good"</span>,
        <span class="st">"High"</span>,             
        <span class="st">"Very high"</span><span class="op">)</span> <span class="op">~</span> <span class="va">K_locus</span>,
    <span class="cn">TRUE</span> <span class="op">~</span> <span class="st">"Unknown"</span><span class="op">)</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">df</span>


<span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/fisher_test.html">row_wise_fisher_test</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">K_locus</span>, <span class="va">df</span><span class="op">$</span><span class="va">`Isolate Type`</span><span class="op">)</span>, 
  simulate.p.value <span class="op">=</span> <span class="cn">TRUE</span>, 
  p.adjust.method <span class="op">=</span> <span class="st">"fdr"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">n</span>,<span class="va">p.adj.signif</span><span class="op">)</span><span class="op">)</span> <span class="op">-&gt;</span> 
  <span class="va">tab</span> 

<span class="va">tab</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kbl.html">kbl</a></span><span class="op">(</span>
    caption <span class="op">=</span> <span class="st">"Benjamini-Hochberg corrected p values testing equal distribution of K-types across invasive and carriage isolates"</span>,
    col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
      <span class="st">"K-type"</span>,
      <span class="st">"Uncorrected p-value"</span>,
      <span class="st">"Benjamini-Hochberg corrected p-values"</span>
    <span class="op">)</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_classic.html">kable_classic</a></span><span class="op">(</span>full_width <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/row_spec.html">row_spec</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">tab</span><span class="op">$</span><span class="va">p.adj</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span>, bold <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<table class="table  lightable-classic">
<caption>
Benjamini-Hochberg corrected p values testing equal distribution of K-types across invasive and carriage isolates
</caption>
<thead><tr>
<th style="text-align:left;">
K-type
</th>
<th style="text-align:right;">
Uncorrected p-value
</th>
<th style="text-align:right;">
Benjamini-Hochberg corrected p-values
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
KL10
</td>
<td style="text-align:right;">
0.157000
</td>
<td style="text-align:right;">
0.6680
</td>
</tr>
<tr>
<td style="text-align:left;">
KL102
</td>
<td style="text-align:right;">
0.054800
</td>
<td style="text-align:right;">
0.6030
</td>
</tr>
<tr>
<td style="text-align:left;">
KL103
</td>
<td style="text-align:right;">
1.000000
</td>
<td style="text-align:right;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
KL104
</td>
<td style="text-align:right;">
0.389000
</td>
<td style="text-align:right;">
0.8280
</td>
</tr>
<tr>
<td style="text-align:left;">
KL105
</td>
<td style="text-align:right;">
1.000000
</td>
<td style="text-align:right;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
KL106
</td>
<td style="text-align:right;">
1.000000
</td>
<td style="text-align:right;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
KL108
</td>
<td style="text-align:right;">
0.523000
</td>
<td style="text-align:right;">
0.8850
</td>
</tr>
<tr>
<td style="text-align:left;">
KL109
</td>
<td style="text-align:right;">
0.389000
</td>
<td style="text-align:right;">
0.8280
</td>
</tr>
<tr>
<td style="text-align:left;">
KL110
</td>
<td style="text-align:right;">
0.160000
</td>
<td style="text-align:right;">
0.6680
</td>
</tr>
<tr>
<td style="text-align:left;">
KL111
</td>
<td style="text-align:right;">
0.032900
</td>
<td style="text-align:right;">
0.4340
</td>
</tr>
<tr>
<td style="text-align:left;">
KL112
</td>
<td style="text-align:right;">
0.161000
</td>
<td style="text-align:right;">
0.6680
</td>
</tr>
<tr>
<td style="text-align:left;">
KL114
</td>
<td style="text-align:right;">
1.000000
</td>
<td style="text-align:right;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
KL115
</td>
<td style="text-align:right;">
1.000000
</td>
<td style="text-align:right;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
KL12
</td>
<td style="text-align:right;">
1.000000
</td>
<td style="text-align:right;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
KL122
</td>
<td style="text-align:right;">
0.389000
</td>
<td style="text-align:right;">
0.8280
</td>
</tr>
<tr>
<td style="text-align:left;">
KL123
</td>
<td style="text-align:right;">
1.000000
</td>
<td style="text-align:right;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
KL125
</td>
<td style="text-align:right;">
0.389000
</td>
<td style="text-align:right;">
0.8280
</td>
</tr>
<tr>
<td style="text-align:left;">
KL127
</td>
<td style="text-align:right;">
0.389000
</td>
<td style="text-align:right;">
0.8280
</td>
</tr>
<tr>
<td style="text-align:left;">
KL13
</td>
<td style="text-align:right;">
1.000000
</td>
<td style="text-align:right;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
KL132
</td>
<td style="text-align:right;">
1.000000
</td>
<td style="text-align:right;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
KL134
</td>
<td style="text-align:right;">
0.389000
</td>
<td style="text-align:right;">
0.8280
</td>
</tr>
<tr>
<td style="text-align:left;">
KL136
</td>
<td style="text-align:right;">
0.523000
</td>
<td style="text-align:right;">
0.8850
</td>
</tr>
<tr>
<td style="text-align:left;">
KL137
</td>
<td style="text-align:right;">
0.285000
</td>
<td style="text-align:right;">
0.8280
</td>
</tr>
<tr>
<td style="text-align:left;">
KL14
</td>
<td style="text-align:right;">
0.562000
</td>
<td style="text-align:right;">
0.9050
</td>
</tr>
<tr>
<td style="text-align:left;">
KL142
</td>
<td style="text-align:right;">
0.389000
</td>
<td style="text-align:right;">
0.8280
</td>
</tr>
<tr>
<td style="text-align:left;">
KL145
</td>
<td style="text-align:right;">
1.000000
</td>
<td style="text-align:right;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
KL149
</td>
<td style="text-align:right;">
0.162000
</td>
<td style="text-align:right;">
0.6680
</td>
</tr>
<tr>
<td style="text-align:left;">
KL15
</td>
<td style="text-align:right;">
0.008640
</td>
<td style="text-align:right;">
0.1430
</td>
</tr>
<tr>
<td style="text-align:left;">
KL151
</td>
<td style="text-align:right;">
0.523000
</td>
<td style="text-align:right;">
0.8850
</td>
</tr>
<tr>
<td style="text-align:left;">
KL155
</td>
<td style="text-align:right;">
0.523000
</td>
<td style="text-align:right;">
0.8850
</td>
</tr>
<tr>
<td style="text-align:left;">
KL157
</td>
<td style="text-align:right;">
1.000000
</td>
<td style="text-align:right;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
KL158
</td>
<td style="text-align:right;">
0.389000
</td>
<td style="text-align:right;">
0.8280
</td>
</tr>
<tr>
<td style="text-align:left;">
KL16
</td>
<td style="text-align:right;">
0.576000
</td>
<td style="text-align:right;">
0.9050
</td>
</tr>
<tr>
<td style="text-align:left;">
KL165
</td>
<td style="text-align:right;">
0.389000
</td>
<td style="text-align:right;">
0.8280
</td>
</tr>
<tr>
<td style="text-align:left;">
KL17
</td>
<td style="text-align:right;">
1.000000
</td>
<td style="text-align:right;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
KL18
</td>
<td style="text-align:right;">
0.285000
</td>
<td style="text-align:right;">
0.8280
</td>
</tr>
<tr>
<td style="text-align:left;">
KL19
</td>
<td style="text-align:right;">
1.000000
</td>
<td style="text-align:right;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
KL2
</td>
<td style="text-align:right;">
0.735000
</td>
<td style="text-align:right;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
KL20
</td>
<td style="text-align:right;">
0.003210
</td>
<td style="text-align:right;">
0.0706
</td>
</tr>
<tr>
<td style="text-align:left;">
KL21
</td>
<td style="text-align:right;">
0.523000
</td>
<td style="text-align:right;">
0.8850
</td>
</tr>
<tr>
<td style="text-align:left;">
KL23
</td>
<td style="text-align:right;">
0.255000
</td>
<td style="text-align:right;">
0.8280
</td>
</tr>
<tr>
<td style="text-align:left;">
KL24
</td>
<td style="text-align:right;">
0.539000
</td>
<td style="text-align:right;">
0.8890
</td>
</tr>
<tr>
<td style="text-align:left;">
KL25
</td>
<td style="text-align:right;">
0.177000
</td>
<td style="text-align:right;">
0.6870
</td>
</tr>
<tr>
<td style="text-align:left;">
KL27
</td>
<td style="text-align:right;">
0.085500
</td>
<td style="text-align:right;">
0.6680
</td>
</tr>
<tr>
<td style="text-align:left;">
KL3
</td>
<td style="text-align:right;">
0.150000
</td>
<td style="text-align:right;">
0.6680
</td>
</tr>
<tr>
<td style="text-align:left;">
KL30
</td>
<td style="text-align:right;">
0.772000
</td>
<td style="text-align:right;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
KL39
</td>
<td style="text-align:right;">
0.652000
</td>
<td style="text-align:right;">
0.9780
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
KL43
</td>
<td style="text-align:right;font-weight: bold;">
0.000171
</td>
<td style="text-align:right;font-weight: bold;">
0.0113
</td>
</tr>
<tr>
<td style="text-align:left;">
KL45
</td>
<td style="text-align:right;">
0.150000
</td>
<td style="text-align:right;">
0.6680
</td>
</tr>
<tr>
<td style="text-align:left;">
KL48
</td>
<td style="text-align:right;">
0.652000
</td>
<td style="text-align:right;">
0.9780
</td>
</tr>
<tr>
<td style="text-align:left;">
KL5
</td>
<td style="text-align:right;">
0.389000
</td>
<td style="text-align:right;">
0.8280
</td>
</tr>
<tr>
<td style="text-align:left;">
KL51
</td>
<td style="text-align:right;">
0.150000
</td>
<td style="text-align:right;">
0.6680
</td>
</tr>
<tr>
<td style="text-align:left;">
KL52
</td>
<td style="text-align:right;">
1.000000
</td>
<td style="text-align:right;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
KL53
</td>
<td style="text-align:right;">
0.389000
</td>
<td style="text-align:right;">
0.8280
</td>
</tr>
<tr>
<td style="text-align:left;">
KL54
</td>
<td style="text-align:right;">
0.523000
</td>
<td style="text-align:right;">
0.8850
</td>
</tr>
<tr>
<td style="text-align:left;">
KL55
</td>
<td style="text-align:right;">
0.150000
</td>
<td style="text-align:right;">
0.6680
</td>
</tr>
<tr>
<td style="text-align:left;">
KL57
</td>
<td style="text-align:right;">
1.000000
</td>
<td style="text-align:right;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
KL59
</td>
<td style="text-align:right;">
1.000000
</td>
<td style="text-align:right;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
KL62
</td>
<td style="text-align:right;font-weight: bold;">
0.001140
</td>
<td style="text-align:right;font-weight: bold;">
0.0376
</td>
</tr>
<tr>
<td style="text-align:left;">
KL63
</td>
<td style="text-align:right;">
1.000000
</td>
<td style="text-align:right;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
KL64
</td>
<td style="text-align:right;">
1.000000
</td>
<td style="text-align:right;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
KL67
</td>
<td style="text-align:right;">
0.523000
</td>
<td style="text-align:right;">
0.8850
</td>
</tr>
<tr>
<td style="text-align:left;">
KL74
</td>
<td style="text-align:right;">
1.000000
</td>
<td style="text-align:right;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
KL8
</td>
<td style="text-align:right;">
0.523000
</td>
<td style="text-align:right;">
0.8850
</td>
</tr>
<tr>
<td style="text-align:left;">
KL9
</td>
<td style="text-align:right;">
1.000000
</td>
<td style="text-align:right;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
Unknown
</td>
<td style="text-align:right;">
0.068300
</td>
<td style="text-align:right;">
0.6440
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/fisher_test.html">row_wise_fisher_test</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">O_locus</span>, <span class="va">df</span><span class="op">$</span><span class="va">`Isolate Type`</span><span class="op">)</span>, 
  simulate.p.value <span class="op">=</span> <span class="cn">TRUE</span>, 
  p.adjust.method <span class="op">=</span> <span class="st">"fdr"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">n</span>,<span class="va">p.adj.signif</span><span class="op">)</span><span class="op">)</span> <span class="op">-&gt;</span> 
  <span class="va">tab</span> 

<span class="va">tab</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kbl.html">kbl</a></span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"Benjamini-Hochberg corrected p values testing equal distribution of O-types across invasive and carriage isolates"</span>,
        col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
      <span class="st">"O-type"</span>,
      <span class="st">"Uncorrected p-value"</span>,
      <span class="st">"Benjamini-Hochberg corrected p-values"</span>
    <span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_classic.html">kable_classic</a></span><span class="op">(</span>full_width <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/row_spec.html">row_spec</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">tab</span><span class="op">$</span><span class="va">p.adj</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span>, bold <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<table class="table  lightable-classic">
<caption>
Benjamini-Hochberg corrected p values testing equal distribution of O-types across invasive and carriage isolates
</caption>
<thead><tr>
<th style="text-align:left;">
O-type
</th>
<th style="text-align:right;">
Uncorrected p-value
</th>
<th style="text-align:right;">
Benjamini-Hochberg corrected p-values
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
O1/O2v1
</td>
<td style="text-align:right;">
0.15000
</td>
<td style="text-align:right;">
0.420
</td>
</tr>
<tr>
<td style="text-align:left;">
O12
</td>
<td style="text-align:right;">
1.00000
</td>
<td style="text-align:right;">
1.000
</td>
</tr>
<tr>
<td style="text-align:left;">
O1v1
</td>
<td style="text-align:right;">
0.20000
</td>
<td style="text-align:right;">
0.467
</td>
</tr>
<tr>
<td style="text-align:left;">
O1v2
</td>
<td style="text-align:right;">
0.05960
</td>
<td style="text-align:right;">
0.342
</td>
</tr>
<tr>
<td style="text-align:left;">
O2v1
</td>
<td style="text-align:right;">
0.29600
</td>
<td style="text-align:right;">
0.592
</td>
</tr>
<tr>
<td style="text-align:left;">
O2v2
</td>
<td style="text-align:right;">
0.63600
</td>
<td style="text-align:right;">
0.897
</td>
</tr>
<tr>
<td style="text-align:left;">
O3/O3a
</td>
<td style="text-align:right;">
0.00846
</td>
<td style="text-align:right;">
0.118
</td>
</tr>
<tr>
<td style="text-align:left;">
O3b
</td>
<td style="text-align:right;">
0.09780
</td>
<td style="text-align:right;">
0.342
</td>
</tr>
<tr>
<td style="text-align:left;">
O4
</td>
<td style="text-align:right;">
0.64100
</td>
<td style="text-align:right;">
0.897
</td>
</tr>
<tr>
<td style="text-align:left;">
O5
</td>
<td style="text-align:right;">
1.00000
</td>
<td style="text-align:right;">
1.000
</td>
</tr>
<tr>
<td style="text-align:left;">
OL101
</td>
<td style="text-align:right;">
0.49100
</td>
<td style="text-align:right;">
0.859
</td>
</tr>
<tr>
<td style="text-align:left;">
OL103
</td>
<td style="text-align:right;">
0.08550
</td>
<td style="text-align:right;">
0.342
</td>
</tr>
<tr>
<td style="text-align:left;">
OL104
</td>
<td style="text-align:right;">
1.00000
</td>
<td style="text-align:right;">
1.000
</td>
</tr>
<tr>
<td style="text-align:left;">
Unknown
</td>
<td style="text-align:right;">
0.75600
</td>
<td style="text-align:right;">
0.962
</td>
</tr>
</tbody>
</table>
</div>
<div id="odds-and-ends-to-calculate-for-manuscript" class="section level2">
<h2 class="hasAnchor">
<a href="#odds-and-ends-to-calculate-for-manuscript" class="anchor"></a>Odds and ends to calculate for manuscript</h2>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">dassimKleb_BTKleb.diversity</span><span class="op">$</span><span class="va">ST</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] 62</span>

<span class="va">dassimKleb_BTKleb.diversity</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">ST</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>median <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>,
            lqi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">0.25</span><span class="op">)</span>,
            uqi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">0.75</span><span class="op">)</span>,
            n_singletons <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">n</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 1 × 4</span>
<span class="co">#&gt;   median   lqi   uqi n_singletons</span>
<span class="co">#&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;        &lt;int&gt;</span>
<span class="co">#&gt; 1      2     1     4           26</span>

<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">dassimKleb_BTKleb.diversity</span><span class="op">$</span><span class="va">K_locus</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] 49</span>

<span class="va">dassimKleb_BTKleb.diversity</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">K_locus</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">ST</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>median <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>,
            lqi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">0.25</span><span class="op">)</span>,
            uqi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">0.75</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 1 × 3</span>
<span class="co">#&gt;   median   lqi   uqi</span>
<span class="co">#&gt;    &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1      1     1     2</span>

<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">dassimKleb_BTKleb.diversity</span><span class="op">$</span><span class="va">O_locus</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] 12</span>

<span class="va">dassimKleb_BTKleb.diversity</span> <span class="op">%&gt;%</span> 
   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>O_locus <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span>
    <span class="va">O_locus_confidence</span> <span class="op">%in%</span> 
           <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Good"</span>,
             <span class="st">"High"</span>,             
             <span class="st">"Very high"</span><span class="op">)</span> <span class="op">~</span> <span class="va">O_locus</span>,
    <span class="cn">TRUE</span> <span class="op">~</span> <span class="st">"Unknown"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>O_locus <span class="op">=</span> 
           <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span>
             <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"O1"</span>, <span class="va">O_locus</span><span class="op">)</span> <span class="op">~</span> <span class="st">"O1"</span>,
             <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"O2"</span>, <span class="va">O_locus</span><span class="op">)</span> <span class="op">~</span> <span class="st">"O2"</span>,
             <span class="cn">TRUE</span> <span class="op">~</span> <span class="va">O_locus</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">O_locus</span> <span class="op">!=</span> <span class="st">"Unknown"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">O_locus</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">ST</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>median <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>,
            lqi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">0.25</span><span class="op">)</span>,
            uqi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">0.75</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 1 × 3</span>
<span class="co">#&gt;   median   lqi   uqi</span>
<span class="co">#&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1      6   2.5  11.8</span>


<span class="va">dassimKleb_BTKleb.amr</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">gene</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"OqxA"</span>, <span class="st">"OqxB"</span>, <span class="st">"AmpH"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">lane</span>, <span class="va">class</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>  
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">lane</span>, <span class="va">class</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">class</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">class</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>, prop <span class="op">=</span> <span class="va">n</span> <span class="op">/</span><span class="fl">203</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt;              class   n        prop</span>
<span class="co">#&gt; 1   Aminoglycoside 198 0.975369458</span>
<span class="co">#&gt; 2  Chloramphenicol 140 0.689655172</span>
<span class="co">#&gt; 3             ESBL 200 0.985221675</span>
<span class="co">#&gt; 4       Fosfomycin   1 0.004926108</span>
<span class="co">#&gt; 5        Macrolide  34 0.167487685</span>
<span class="co">#&gt; 6    Penicillinase 200 0.985221675</span>
<span class="co">#&gt; 7        Quinolone  76 0.374384236</span>
<span class="co">#&gt; 8       Rifampicin  52 0.256157635</span>
<span class="co">#&gt; 9     Sulphonamide 201 0.990147783</span>
<span class="co">#&gt; 10    Tetracycline 120 0.591133005</span>
<span class="co">#&gt; 11    Trimethoprim 198 0.975369458</span>


<span class="va">btESBL_qrdr_mutations</span> <span class="op">%&gt;%</span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">genus</span> <span class="op">==</span> <span class="st">"K. pneumoniae complex"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">genus</span><span class="op">)</span> <span class="op">%&gt;%</span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter-joins.html">semi_join</a></span><span class="op">(</span>
        <span class="va">btESBL_CARD_qrdr_mutations</span>, 
        by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"variant"</span> <span class="op">=</span> <span class="st">"variant"</span>,
               <span class="st">"gene"</span> <span class="op">=</span>  <span class="st">"gene"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
       <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">gene</span>,<span class="va">variant</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 2 × 3</span>
<span class="co">#&gt;   gene  variant     n</span>
<span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt;   &lt;int&gt;</span>
<span class="co">#&gt; 1 gyrA  S83F       10</span>
<span class="co">#&gt; 2 parC  S80I        1</span>

<span class="va">dassimKleb_globalKleb.metadata</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">location</span> <span class="op">==</span> <span class="st">"Malawi"</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>ESBL <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else</a></span><span class="op">(</span><span class="va">ESBL</span> <span class="op">==</span> <span class="st">"ESBL"</span>, <span class="st">"ESBL"</span>, <span class="st">"Not ESBL"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">ybt</span>, <span class="va">clb</span>, <span class="va">iuc</span>, <span class="va">iro</span>, <span class="va">rmpA</span>, <span class="va">rmpA2</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;   ybt clb iuc iro rmpA rmpA2</span>
<span class="co">#&gt; 1  94   4  19   9    4    19</span>

<span class="co"># virulence by carriage vs infection</span>

<span class="va">dassimKleb_globalKleb.metadata</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">location</span> <span class="op">==</span> <span class="st">"Malawi"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>ESBL <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else</a></span><span class="op">(</span><span class="va">ESBL</span> <span class="op">==</span> <span class="st">"ESBL"</span>, <span class="st">"ESBL"</span>, <span class="st">"Not ESBL"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">`Isolate Type`</span>, <span class="va">ybt</span>, <span class="va">clb</span>, <span class="va">iuc</span>, <span class="va">iro</span>, <span class="va">rmpA</span>, <span class="va">rmpA2</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">`Isolate Type`</span><span class="op">)</span> <span class="op">%&gt;%</span>  
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 2 × 7</span>
<span class="co">#&gt;   `Isolate Type`   ybt   clb   iuc   iro  rmpA rmpA2</span>
<span class="co">#&gt;   &lt;chr&gt;          &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1 Colonising        68     0     1     1     1     1</span>
<span class="co">#&gt; 2 Invasive          26     4    18     8     3    18</span>

<span class="va">dassimKleb_globalKleb.metadata</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">location</span> <span class="op">==</span> <span class="st">"Malawi"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">`Isolate Type`</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">tally</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 2 × 2</span>
<span class="co">#&gt;   `Isolate Type`     n</span>
<span class="co">#&gt;   &lt;chr&gt;          &lt;int&gt;</span>
<span class="co">#&gt; 1 Colonising       214</span>
<span class="co">#&gt; 2 Invasive         139</span>

<span class="va">dassimKleb_globalKleb.metadata</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">location</span> <span class="op">==</span> <span class="st">"Malawi"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">ESBL</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">tally</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 2 × 2</span>
<span class="co">#&gt;   ESBL      n</span>
<span class="co">#&gt;   &lt;chr&gt; &lt;int&gt;</span>
<span class="co">#&gt; 1 0        47</span>
<span class="co">#&gt; 2 ESBL    306</span>

<span class="va">dassimKleb_globalKleb.metadata</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">location</span> <span class="op">==</span> <span class="st">"Malawi"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>ESBL <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else</a></span><span class="op">(</span><span class="va">ESBL</span> <span class="op">==</span> <span class="st">"ESBL"</span>, <span class="st">"ESBL"</span>, <span class="st">"Not ESBL"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">ESBL</span>, <span class="va">ybt</span>, <span class="va">clb</span>, <span class="va">iuc</span>, <span class="va">iro</span>, <span class="va">rmpA</span>, <span class="va">rmpA2</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">ESBL</span><span class="op">)</span> <span class="op">%&gt;%</span>  
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 2 × 7</span>
<span class="co">#&gt;   ESBL       ybt   clb   iuc   iro  rmpA rmpA2</span>
<span class="co">#&gt;   &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1 ESBL        89     4     8     8     4     8</span>
<span class="co">#&gt; 2 Not ESBL     5     0    11     1     0    11</span>

<span class="va">dassimKleb_globalKleb.metadata</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">ST</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ST218"</span>, <span class="st">"ST268"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;                    name ESBL Sample accession   study Sample Source</span>
<span class="co">#&gt; 16228_1_61   16228_1_61    0        ERS669098 musciha         Human</span>
<span class="co">#&gt; 16228_1_64   16228_1_64 ESBL        ERS669104 musciha         Human</span>
<span class="co">#&gt; 16228_1_77   16228_1_77 ESBL        ERS669129 musciha         Human</span>
<span class="co">#&gt; 16228_1_83   16228_1_83 ESBL        ERS669139 musciha         Human</span>
<span class="co">#&gt; 22036_8_82   22036_8_82 ESBL       ERS1545129 cornick         Human</span>
<span class="co">#&gt; 22072_1_143 22072_1_143 ESBL       ERS1531011 cornick         Human</span>
<span class="co">#&gt; 22072_1_151 22072_1_151 ESBL       ERS1531021 cornick         Human</span>
<span class="co">#&gt; 22072_1_163 22072_1_163 ESBL       ERS1531039 cornick         Human</span>
<span class="co">#&gt; 22072_1_241 22072_1_241 ESBL       ERS1531130 cornick         Human</span>
<span class="co">#&gt;             Isolate Type location    ST    YbST   CbST  AbST  SmST rmpA rmpA2</span>
<span class="co">#&gt; 16228_1_61      Invasive   Malawi ST218       0      0     1     1    0     1</span>
<span class="co">#&gt; 16228_1_64      Invasive   Malawi ST268 234-3LV 13-1LV 1-1LV 1-1LV    0     1</span>
<span class="co">#&gt; 16228_1_77      Invasive   Malawi ST268 234-3LV 13-1LV 1-1LV     1    0     1</span>
<span class="co">#&gt; 16228_1_83      Invasive   Malawi ST218       0      0 1-1LV 1-1LV    0     1</span>
<span class="co">#&gt; 22036_8_82      Invasive   Malawi ST218       0      0 1-1LV 1-1LV    1     1</span>
<span class="co">#&gt; 22072_1_143     Invasive   Malawi ST268 234-3LV 13-1LV 1-1LV     1    0     1</span>
<span class="co">#&gt; 22072_1_151     Invasive   Malawi ST268 234-3LV 13-1LV 1-1LV     1    1     1</span>
<span class="co">#&gt; 22072_1_163     Invasive   Malawi ST268 120-6LV      0     0     0    0     0</span>
<span class="co">#&gt; 22072_1_241     Invasive   Malawi ST218       0      0 1-1LV 1-1LV    1     1</span>
<span class="co">#&gt;             O_locus K_locus K_locus_confidence O_locus_confidence ybt clb iuc</span>
<span class="co">#&gt; 16228_1_61     O2v2    KL57          Very high          Very high   0   0   1</span>
<span class="co">#&gt; 16228_1_64     O2v1    KL20          Very high          Very high   1   1   1</span>
<span class="co">#&gt; 16228_1_77     O2v1    KL20          Very high          Very high   1   1   1</span>
<span class="co">#&gt; 16228_1_83     O2v2    KL57          Very high          Very high   0   0   1</span>
<span class="co">#&gt; 22036_8_82     O2v2    KL57          Very high          Very high   0   0   1</span>
<span class="co">#&gt; 22072_1_143    O2v1    KL20          Very high          Very high   1   1   1</span>
<span class="co">#&gt; 22072_1_151    O2v1    KL20          Very high          Very high   1   1   1</span>
<span class="co">#&gt; 22072_1_163    O2v1    KL20          Very high          Very high   1   0   0</span>
<span class="co">#&gt; 22072_1_241    O2v2    KL57               High          Very high   0   0   1</span>
<span class="co">#&gt;             iro Malawi</span>
<span class="co">#&gt; 16228_1_61    1      1</span>
<span class="co">#&gt; 16228_1_64    1      1</span>
<span class="co">#&gt; 16228_1_77    1      1</span>
<span class="co">#&gt; 16228_1_83    1      1</span>
<span class="co">#&gt; 22036_8_82    1      1</span>
<span class="co">#&gt; 22072_1_143   1      1</span>
<span class="co">#&gt; 22072_1_151   1      1</span>
<span class="co">#&gt; 22072_1_163   0      1</span>
<span class="co">#&gt; 22072_1_241   1      1</span>

<span class="va">dassimKleb_globalKleb.metadata</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">location</span> <span class="op">==</span> <span class="st">"Malawi"</span><span class="op">)</span> <span class="op">%&gt;%</span>  
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>vir <span class="op">=</span> <span class="va">clb</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">|</span>
           <span class="va">iuc</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">|</span> <span class="va">iro</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">|</span> <span class="va">rmpA</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">|</span> <span class="va">rmpA2</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span>  
              <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">ESBL</span> <span class="op">==</span> <span class="st">"ESBL"</span> <span class="op">&amp;</span> <span class="va">vir</span> <span class="op">==</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt;                    name ESBL Sample accession   study Sample Source</span>
<span class="co">#&gt; 16228_1_64   16228_1_64 ESBL        ERS669104 musciha         Human</span>
<span class="co">#&gt; 16228_1_77   16228_1_77 ESBL        ERS669129 musciha         Human</span>
<span class="co">#&gt; 16228_1_83   16228_1_83 ESBL        ERS669139 musciha         Human</span>
<span class="co">#&gt; 22036_8_82   22036_8_82 ESBL       ERS1545129 cornick         Human</span>
<span class="co">#&gt; 22072_1_143 22072_1_143 ESBL       ERS1531011 cornick         Human</span>
<span class="co">#&gt; 22072_1_151 22072_1_151 ESBL       ERS1531021 cornick         Human</span>
<span class="co">#&gt; 22072_1_241 22072_1_241 ESBL       ERS1531130 cornick         Human</span>
<span class="co">#&gt; 34154_7_87   34154_7_87 ESBL             &lt;NA&gt;  DASSIM         Human</span>
<span class="co">#&gt;             Isolate Type location    ST    YbST   CbST  AbST  SmST rmpA rmpA2</span>
<span class="co">#&gt; 16228_1_64      Invasive   Malawi ST268 234-3LV 13-1LV 1-1LV 1-1LV    0     1</span>
<span class="co">#&gt; 16228_1_77      Invasive   Malawi ST268 234-3LV 13-1LV 1-1LV     1    0     1</span>
<span class="co">#&gt; 16228_1_83      Invasive   Malawi ST218       0      0 1-1LV 1-1LV    0     1</span>
<span class="co">#&gt; 22036_8_82      Invasive   Malawi ST218       0      0 1-1LV 1-1LV    1     1</span>
<span class="co">#&gt; 22072_1_143     Invasive   Malawi ST268 234-3LV 13-1LV 1-1LV     1    0     1</span>
<span class="co">#&gt; 22072_1_151     Invasive   Malawi ST268 234-3LV 13-1LV 1-1LV     1    1     1</span>
<span class="co">#&gt; 22072_1_241     Invasive   Malawi ST218       0      0 1-1LV 1-1LV    1     1</span>
<span class="co">#&gt; 34154_7_87    Colonising   Malawi  ST25       0      0     1     1    1     1</span>
<span class="co">#&gt;             O_locus K_locus K_locus_confidence O_locus_confidence ybt clb iuc</span>
<span class="co">#&gt; 16228_1_64     O2v1    KL20          Very high          Very high   1   1   1</span>
<span class="co">#&gt; 16228_1_77     O2v1    KL20          Very high          Very high   1   1   1</span>
<span class="co">#&gt; 16228_1_83     O2v2    KL57          Very high          Very high   0   0   1</span>
<span class="co">#&gt; 22036_8_82     O2v2    KL57          Very high          Very high   0   0   1</span>
<span class="co">#&gt; 22072_1_143    O2v1    KL20          Very high          Very high   1   1   1</span>
<span class="co">#&gt; 22072_1_151    O2v1    KL20          Very high          Very high   1   1   1</span>
<span class="co">#&gt; 22072_1_241    O2v2    KL57               High          Very high   0   0   1</span>
<span class="co">#&gt; 34154_7_87     O1v2     KL2          Very high          Very high   0   0   1</span>
<span class="co">#&gt;             iro Malawi  vir</span>
<span class="co">#&gt; 16228_1_64    1      1 TRUE</span>
<span class="co">#&gt; 16228_1_77    1      1 TRUE</span>
<span class="co">#&gt; 16228_1_83    1      1 TRUE</span>
<span class="co">#&gt; 22036_8_82    1      1 TRUE</span>
<span class="co">#&gt; 22072_1_143   1      1 TRUE</span>
<span class="co">#&gt; 22072_1_151   1      1 TRUE</span>
<span class="co">#&gt; 22072_1_241   1      1 TRUE</span>
<span class="co">#&gt; 34154_7_87    1      1 TRUE</span>

<span class="co"># simpsons diversity</span>

<span class="va">dassimKleb_BTKleb.diversity</span> <span class="op">%&gt;%</span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>K_locus <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span>
        <span class="va">K_locus_confidence</span> <span class="op">%in%</span> 
            <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Good"</span>,
              <span class="st">"High"</span>,             
              <span class="st">"Very high"</span><span class="op">)</span> <span class="op">~</span> <span class="va">K_locus</span>,
        <span class="cn">TRUE</span> <span class="op">~</span> <span class="cn">NA_character_</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>O_locus <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span>
        <span class="va">O_locus_confidence</span> <span class="op">%in%</span> 
            <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Good"</span>,
              <span class="st">"High"</span>,             
              <span class="st">"Very high"</span><span class="op">)</span> <span class="op">~</span> <span class="va">O_locus</span>,
        <span class="cn">TRUE</span> <span class="op">~</span> <span class="cn">NA_character_</span><span class="op">)</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">df</span></code></pre></div>
<div id="reproducability-session-info" class="section level3">
<h3 class="hasAnchor">
<a href="#reproducability-session-info" class="anchor"></a>Reproducability, session info</h3>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; R version 4.1.1 (2021-08-10)</span>
<span class="co">#&gt; Platform: aarch64-apple-darwin20 (64-bit)</span>
<span class="co">#&gt; Running under: macOS Big Sur 11.6</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Matrix products: default</span>
<span class="co">#&gt; BLAS:   /Library/Frameworks/R.framework/Versions/4.1-arm64/Resources/lib/libRblas.0.dylib</span>
<span class="co">#&gt; LAPACK: /Library/Frameworks/R.framework/Versions/4.1-arm64/Resources/lib/libRlapack.dylib</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; locale:</span>
<span class="co">#&gt; [1] en_GB.UTF-8/en_GB.UTF-8/en_GB.UTF-8/C/en_GB.UTF-8/en_GB.UTF-8</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attached base packages:</span>
<span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; other attached packages:</span>
<span class="co">#&gt;  [1] stringr_1.4.0           blantyreESBL_0.1.0.0000 ggplotify_0.1.0        </span>
<span class="co">#&gt;  [4] pheatmap_1.0.12         viridis_0.6.1           viridisLite_0.4.0      </span>
<span class="co">#&gt;  [7] scales_1.1.1            patchwork_1.1.1         kableExtra_1.3.4       </span>
<span class="co">#&gt; [10] here_1.0.1              tidyr_1.1.3             forcats_0.5.1          </span>
<span class="co">#&gt; [13] dplyr_1.0.7             ggpubr_0.4.0            ggplot2_3.3.5          </span>
<span class="co">#&gt; [16] cowplot_1.1.1           ggtree_3.0.4            phytools_0.7-80        </span>
<span class="co">#&gt; [19] maps_3.3.0              ape_5.5                 rstatix_0.7.0          </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; loaded via a namespace (and not attached):</span>
<span class="co">#&gt;   [1] colorspace_2.0-2        ggsignif_0.6.3          ellipsis_0.3.2         </span>
<span class="co">#&gt;   [4] rio_0.5.27              rprojroot_2.0.2         fs_1.5.0               </span>
<span class="co">#&gt;   [7] aplot_0.0.6             rstudioapi_0.13         farver_2.1.0           </span>
<span class="co">#&gt;  [10] fansi_0.5.0             xml2_1.3.2              codetools_0.2-18       </span>
<span class="co">#&gt;  [13] mnormt_2.0.2            cachem_1.0.6            knitr_1.33             </span>
<span class="co">#&gt;  [16] jsonlite_1.7.2          broom_0.7.9             compiler_4.1.1         </span>
<span class="co">#&gt;  [19] httr_1.4.2              backports_1.2.1         assertthat_0.2.1       </span>
<span class="co">#&gt;  [22] Matrix_1.3-4            fastmap_1.1.0           lazyeval_0.2.2         </span>
<span class="co">#&gt;  [25] cli_3.0.1               htmltools_0.5.2         tools_4.1.1            </span>
<span class="co">#&gt;  [28] igraph_1.2.6            coda_0.19-4             gtable_0.3.0           </span>
<span class="co">#&gt;  [31] glue_1.4.2              clusterGeneration_1.3.7 fastmatch_1.1-3        </span>
<span class="co">#&gt;  [34] Rcpp_1.0.7              carData_3.0-4           cellranger_1.1.0       </span>
<span class="co">#&gt;  [37] jquerylib_0.1.4         pkgdown_1.6.1           vctrs_0.3.8            </span>
<span class="co">#&gt;  [40] svglite_2.0.0           nlme_3.1-152            xfun_0.25              </span>
<span class="co">#&gt;  [43] openxlsx_4.2.4          rvest_1.0.1             lifecycle_1.0.0        </span>
<span class="co">#&gt;  [46] phangorn_2.7.1          MASS_7.3-54             ragg_1.1.3             </span>
<span class="co">#&gt;  [49] hms_1.1.0               parallel_4.1.1          expm_0.999-6           </span>
<span class="co">#&gt;  [52] RColorBrewer_1.1-2      yaml_2.2.1              curl_4.3.2             </span>
<span class="co">#&gt;  [55] memoise_2.0.0           gridExtra_2.3           ggfun_0.0.3            </span>
<span class="co">#&gt;  [58] yulab.utils_0.0.2       sass_0.4.0              stringi_1.7.4          </span>
<span class="co">#&gt;  [61] highr_0.9               desc_1.3.0              plotrix_3.8-1          </span>
<span class="co">#&gt;  [64] tidytree_0.3.4          zip_2.2.0               rlang_0.4.11           </span>
<span class="co">#&gt;  [67] pkgconfig_2.0.3         systemfonts_1.0.2       evaluate_0.14          </span>
<span class="co">#&gt;  [70] lattice_0.20-44         purrr_0.3.4             labeling_0.4.2         </span>
<span class="co">#&gt;  [73] treeio_1.16.2           tidyselect_1.1.1        magrittr_2.0.1         </span>
<span class="co">#&gt;  [76] R6_2.5.1                generics_0.1.0          combinat_0.0-8         </span>
<span class="co">#&gt;  [79] DBI_1.1.1               pillar_1.6.2            haven_2.4.3            </span>
<span class="co">#&gt;  [82] foreign_0.8-81          withr_2.4.2             scatterplot3d_0.3-41   </span>
<span class="co">#&gt;  [85] abind_1.4-5             tibble_3.1.4            crayon_1.4.1           </span>
<span class="co">#&gt;  [88] car_3.0-11              utf8_1.2.2              tmvnsim_1.0-2          </span>
<span class="co">#&gt;  [91] rmarkdown_2.10          grid_4.1.1              readxl_1.3.1           </span>
<span class="co">#&gt;  [94] data.table_1.14.0       digest_0.6.27           webshot_0.5.2          </span>
<span class="co">#&gt;  [97] numDeriv_2016.8-1.1     gridGraphics_0.5-1      textshaping_0.3.5      </span>
<span class="co">#&gt; [100] munsell_0.5.0           bslib_0.2.5.1           quadprog_1.5-8</span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Joseph Lewis.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
